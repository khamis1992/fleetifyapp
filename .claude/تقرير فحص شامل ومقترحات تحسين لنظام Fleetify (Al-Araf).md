# تقرير فحص شامل ومقترحات تحسين لنظام Fleetify (Al-Araf)

**تاريخ التقرير:** 5 نوفمبر 2025

**مقدمة:**

بناءً على طلبكم، تم إجراء فحص شامل لنظام Fleetify المستخدم في موقع alaraf.online. يهدف هذا التقرير إلى تحديد المشاكل الحالية في النظام، وتقديم مقترحات لتحسين تجربة المستخدم، ومراجعة الـ workflow خاصة في النظام المالي ونظام إنشاء العقود، بالإضافة إلى توثيق جميع الأخطاء الفنية التي تم اكتشافها في الكونسول. تم إعداد هذا التقرير ليكون دليلاً عملياً للمبرمج المسؤول عن تطوير النظام وإصلاح المشاكل.

## ملخص تنفيذي

يعاني النظام من عدة مشاكل حرجة وجوهرية تؤثر بشكل كبير على استقراره وقابليته للاستخدام، خاصة في الجانب المالي. أهم هذه المشاكل هي **عدم تكامل البيانات المالية** بين الوحدات المختلفة (العقود، الفواتير، التقارير)، ووجود **صفحات مالية أساسية لا تعمل** (مثل صفحة المدفوعات)، بالإضافة إلى **ظهور أرقام صفرية في جميع التقارير المالية**، مما يجعلها عديمة الفائدة. كما تم رصد **أخطاء تقنية متكررة (HTTP 400 & 406)** في جميع صفحات النظام، مما يدل على وجود مشاكل في طلبات الـ API.

يوصي هذا التقرير بالتركيز الفوري على إصلاح المشاكل الحرجة في النظام المالي، وتوحيد البيانات، وإصلاح أخطاء الكونسول، ثم الانتقال إلى تحسين تجربة المستخدم في بقية أجزاء النظام.

---


## 1. تقرير شامل عن أخطاء الكونسول في النظام

تم اكتشاف أخطاء متكررة في **جميع صفحات النظام** بدون استثناء. هذه الأخطاء تظهر في كل صفحة تم فحصها وتدل على مشاكل أساسية في البنية التحتية للنظام.

### 1.1. الأخطاء المتكررة

#### 1.1.1. خطأ Manifest Icon (يظهر في كل صفحة)

```
Error while trying to use the following icon from the Manifest: 
https://www.alaraf.online/lovable-uploads/7453c280-3175-4ccf-a73b-24921ec5990b.png 
(Download error or resource isn't a valid image)
```

- **الوصف:** فشل تحميل أيقونة التطبيق من Manifest.
- **التأثير:** يؤثر على وظائف PWA (Progressive Web App) وقد يمنع تثبيت التطبيق على الأجهزة.
- **الحل المقترح:** التحقق من وجود الملف في المسار المحدد، والتأكد من صلاحيته، وتحديث ملف `manifest.json`.

#### 1.1.2. أخطاء 400 Bad Request (متعددة في كل صفحة)

```
Failed to load resource: the server responded with a status of 400 ()
```

- **العدد:** يتراوح بين 14-22 خطأ في كل صفحة.
- **الوصف:** طلبات HTTP فاشلة بسبب صياغة غير صحيحة للطلب (Bad Request).
- **الأسباب المحتملة:** طلبات API بمعاملات خاطئة، مشاكل في المصادقة، بيانات مفقودة، أو مشاكل في CORS.
- **التأثير:** قد يؤدي إلى عدم تحميل البيانات بشكل صحيح، ويؤثر سلباً على أداء النظام.
- **الحل المقترح:** فحص الطلبات الفاشلة في `Network tab` في أدوات المطورين، ومراجعة كود الـ API calls في الواجهة الأمامية.

#### 1.1.3. خطأ 406 Not Acceptable (يظهر مرة واحدة في كل صفحة)

```
Failed to load resource: the server responded with a status of 406 ()
```

- **الوصف:** الخادم لا يستطيع إنتاج استجابة تتوافق مع `Accept headers` المرسلة من المتصفح.
- **الأسباب المحتملة:** مشكلة في `Content Negotiation`، أو أن الخادم لا يدعم تنسيق البيانات المطلوب.
- **الحل المقترح:** فحص الطلب المحدد الذي يسبب هذا الخطأ والتحقق من `Accept headers`.

### 1.2. إحصائيات الأخطاء حسب الصفحة

| الصفحة | أخطاء 400 | أخطاء 406 | خطأ Manifest | الإجمالي |
|---|---|---|---|---|
| الصفحة الرئيسية | 14 | 1 | 1 | 16 |
| دليل الحسابات | 14 | 1 | 1 | 16 |
| الفواتير | 14 | 1 | 1 | 16 |
| المدفوعات (فشلت) | 14 | 0 | 1 | 15 |
| التحليل المالي | 16 | 1 | 1 | 18 |
| إدارة المركبات | 14 | 1 | 1 | 16 |
| العملاء | 18 | 1 | 1 | 20 |
| التقارير المالية | 20 | 1 | 1 | 22 |
| تتبع المدفوعات | 22 | 1 | 1 | 24 |

### 1.3. التأثير العام والإجراءات المطلوبة

هذه الأخطاء المتكررة تؤدي إلى بطء في تحميل الصفحات، استهلاك غير ضروري للموارد، وتجربة مستخدم سيئة. **يجب على المبرمج فحص `Network Tab` في أدوات المطورين لتحديد الطلبات الفاشلة وإصلاحها بشكل فوري.**

---


## 2. مشاكل النظام المالي (Financial System)

يعاني النظام المالي من مشاكل حرجة وجوهرية تمنع استخدامه بشكل فعال. تم تلخيص المشاكل والتحسينات المقترحة في الأقسام التالية:

### 2.1. صفحة التحليل المالي (/finance/analysis)

- **الحالة:** الصفحة غير مكتملة وتعرض رسالة "نظام التحليل المالي قيد التطوير".
- **المشكلة:** جميع الأرقام المعروضة (الإيرادات، المصروفات، الربح المالي) هي صفر، ولا توجد أي رسوم بيانية أو تحليلات فعلية.
- **عدم اتساق البيانات:** الأرقام المعروضة هنا (0.000 د.ك) تتناقض بشكل صارخ مع الأرقام الموجودة في صفحات أخرى (مثل 197,691 ر.ق في العقود و 1,709,174 QAR في الفواتير).
- **عدم اتساق العملة:** تستخدم الصفحة عملة "د.ك" (دينار كويتي)، بينما تستخدم صفحات أخرى "ر.ق" أو "QAR".
- **التحسينات المقترحة:**
    - **إكمال تطوير الصفحة:** يجب إنهاء تطوير نظام التحليل المالي وربطه بالبيانات الحقيقية.
    - **توحيد البيانات والعملة:** يجب التأكد من أن جميع أجزاء النظام المالي تستخدم نفس البيانات ونفس العملة.
    - **إضافة ميزات تحليلية:** يجب إضافة رسوم بيانية تفاعلية، مقارنات بين الفترات، تحليل لمراكز التكلفة، ونسب مالية.

---


### 2.2. صفحة المدفوعات (/finance/payments)

- **الحالة:** **خطأ حرج (Critical Error)**. الصفحة لا تعمل على الإطلاق.
- **المشكلة:** عند محاولة فتح الصفحة، تفشل في التحميل وتعرض رسالة "حدث خطأ غير متوقع". هذا يمنع المستخدمين من عرض، تسجيل، أو إدارة أي مدفوعات.
- **التأثير:** هذا العطل يجعل جزءاً أساسياً من النظام المالي غير قابل للاستخدام، ويؤثر بشكل مباشر على قدرة الشركة على تتبع إيراداتها.
- **الأسباب المحتملة:** قد يكون السبب خطأ في كود الصفحة، مشكلة في الاتصال بقاعدة البيانات، أو خطأ في الـ API endpoint الخاص بالمدفوعات.
- **الإجراء المطلوب:** **إصلاح هذه الصفحة بشكل فوري وعاجل**. يجب على المبرمج فحص سجلات الخادم (server logs) وأخطاء الكونسول لتحديد السبب الجذري للمشكلة وحلها.

---


### 2.3. صفحة التقارير المالية (/finance/reports)

- **الحالة:** الصفحة تعمل، لكنها **عديمة الفائدة** حالياً.
- **المشكلة الحرجة:** **جميع الأرقام في جميع التقارير المالية (الميزانية العمومية، قائمة الدخل، إلخ) هي صفر (QAR 0)**. هذا يدل على عدم وجود أي قيود محاسبية مسجلة في النظام، أو أن التقارير غير مربوطة بدفتر الأستاذ.
- **تناقض البيانات:** هذا يتعارض بشكل مباشر مع وجود إيرادات مسجلة في وحدات أخرى من النظام.
- **مشاكل تجربة المستخدم:**
    - **التقرير طويل جداً:** الميزانية العمومية تحتوي على مئات الحسابات الفرعية، مما يجعلها صعبة القراءة. يجب إضافة خاصية طي/فتح الحسابات (collapsible view).
    - **مشاكل ترجمة:** يوجد خليط بين العربية والإنجليزية في أسماء الحسابات (مثال: "النقد وما في حكمه" ثم "Main النقد Box").
    - **نقص في التحليل:** لا توجد رسوم بيانية، مقارنات مع فترات سابقة، أو نسب مالية.
- **الإجراءات المطلوبة بشكل عاجل:**
    - **تفعيل القيود المحاسبية التلقائية:** يجب على النظام إنشاء قيود محاسبية تلقائياً لجميع العمليات (عقود، فواتير، مدفوعات، صيانة، رواتب).
    - **إدخال الأرصدة الافتتاحية:** يجب تهيئة النظام محاسبياً بإدخال الأرصدة الافتتاحية لجميع الحسابات.
    - **تحسين واجهة التقارير:** إضافة خاصية طي الحسابات، رسوم بيانية، وتصدير إلى Excel/PDF.

---


### 2.4. صفحة تتبع المدفوعات (/financial-tracking)

- **الحالة:** الصفحة تعمل، لكنها **فارغة تماماً** ولا تعرض أي بيانات.
- **المشكلة:** لا يوجد أي محتوى في الصفحة باستثناء حقل بحث وثلاثة تبويبات غير واضحة ("مدفوعات العملاء"، "الإيرادات الشهرية"، "غير المدفوعة بالشهر").
- **تداخل الوظائف:** من غير الواضح ما هو الفرق بين هذه الصفحة وصفحة "المدفوعات" التي لا تعمل. يبدو أن هناك تداخلاً في الوظائف أو عدم وضوح في تصميم النظام.
- **التحسينات المقترحة:**
    - **توضيح الغرض أو الدمج:** يجب إما دمج هذه الصفحة مع صفحة "المدفوعات" الرئيسية، أو توضيح وظيفتها بشكل أفضل.
    - **عرض البيانات:** يجب أن تعرض الصفحة جداول واضحة للمدفوعات المستحقة والمتأخرة، مع إحصائيات ورسوم بيانية.
    - **إضافة ميزات التتبع:** يجب إضافة نظام تنبيهات للمدفوعات المستحقة والمتأخرة، مع إمكانية إرسال تذكيرات للعملاء.
    - **التكامل مع الشؤون القانونية:** يجب تفعيل الربط مع قسم الشؤون القانونية لتحويل العملاء المتأخرين عن السداد تلقائياً.

---


## 3. مشاكل نظام إنشاء العقود (Contracts Workflow)

تم فحص صفحة العقود ونموذج إنشاء عقد جديد، وتم رصد المشاكل والتحسينات التالية:

### 3.1. صفحة العقود (/contracts)

- **نقاط إيجابية:** الصفحة تعرض قائمة بالعقود مع إحصائيات واضحة (122 عقد نشط، 391 عقد ملغي)، والبيانات تبدو مترابطة بشكل صحيح مع العملاء والمركبات.
- **مشاكل تجربة المستخدم:**
    - **تنسيق رقم العقد غير موحد:** تظهر أرقام عقود بتنسيقات مختلفة (مثل `CNT-4018-2024`, `In2018169`)، مما يدل على عدم وجود نظام ترقيم موحد.
    - **الأزرار متقاربة:** أزرار الإجراءات (عرض، تعديل، تجديد، إلغاء) متقاربة جداً، مما يزيد من احتمالية النقر الخاطئ.
    - **حالات غير واضحة:** ألوان حالات العقود (نشط، منتهي، ملغي) غير مميزة بشكل كافٍ.
- **التحسينات المقترحة:**
    - **توحيد نظام الترقيم:** يجب تطبيق نظام ترقيم موحد على جميع العقود.
    - **تحسين تصميم الأزرار:** يمكن دمج الأزرار في قائمة منسدلة (dropdown menu) لكل عقد.
    - **تحسين عرض الحالات:** استخدام ألوان وأيقونات أكثر وضوحاً لتمييز حالات العقود.

### 3.2. نموذج إنشاء عقد جديد

- **الحالة:** النموذج يعمل، لكنه يعاني من عدة مشاكل في التصميم و الـ workflow.
- **مشاكل الـ Workflow:**
    - **زر "السابق" في الخطوة الأولى:** وجود زر "السابق" في الخطوة الأولى من النموذج لا معنى له.
    - **غياب مؤشرات الحقول المطلوبة:** لا توجد علامة واضحة (مثل `*`) لتحديد الحقول الإلزامية.
    - **زر "بيانات تجريبية":** وجود زر لملء بيانات تجريبية مفيد للاختبار، لكن يجب إخفاؤه في نسخة الإنتاج.
- **مشاكل التصميم:**
    - **استخدام الألوان:** استخدام اللون الأحمر في تصميم الحقول قد يوحي للمستخدم بوجود خطأ حتى قبل إدخال البيانات.
    - **شريط التقدم:** النسبة المئوية في شريط التقدم لا تتطابق مع رقم الخطوة (الخطوة 1 من 6 تظهر 17% بدلاً من 16.67%).
- **التحسينات المقترحة:**
    - **تحسين الـ Workflow:** إخفاء زر "السابق" في الخطوة الأولى، إضافة مؤشرات للحقول المطلوبة، وإضافة `validation` للتحقق من البيانات في الوقت الفعلي.
    - **تحسين التصميم:** استخدام ألوان محايدة للحقول، واستخدام اللون الأحمر فقط عند وجود أخطاء فعلية، وتصحيح النسبة المئوية في شريط التقدم.

---


## 4. مشاكل صفحات النظام الأخرى

تم فحص عدد من الصفحات الرئيسية الأخرى في النظام، وتم تلخيص الملاحظات والتحسينات المقترحة أدناه:

### 4.1. صفحة العملاء (/customers)

- **الحالة:** الصفحة تعمل بشكل جيد وتعرض قائمة بالعملاء مع إحصائيات واضحة (709 عميل).
- **مشاكل تجربة المستخدم:**
    - **عرض معرف UUID:** يتم عرض معرف UUID التقني لكل عميل في الجدول، وهو معلومة غير مفيدة للمستخدم النهائي وتشغل مساحة.
    - **أيقونات غير واضحة:** أيقونات الإجراءات (عرض، تعديل، حذف) غير مصحوبة بنصوص توضيحية (labels)، مما يجعلها غامضة.
- **التحسينات المقترحة:**
    - **إخفاء UUID:** يجب إزالة عمود UUID من العرض الافتراضي للجدول.
    - **توضيح الأيقونات:** يجب إضافة نصوص توضيحية (tooltips) للأيقونات عند مرور الماوس فوقها، أو استبدالها بقائمة منسدلة واضحة.
    - **إضافة معلومات مفيدة:** يمكن تحسين الجدول بإضافة معلومات أكثر فائدة مثل "تاريخ آخر نشاط" أو "إجمالي الرصيد المستحق" لكل عميل.

---


### 4.2. صفحة إدارة المركبات (/fleet)

- **الحالة:** الصفحة تعمل وتعرض قائمة بالمركبات مع إحصائيات (206 مركبة).
- **مشاكل تجربة المستخدم:**
    - **عدم عرض الصور:** معظم المركبات لا تعرض صورها، وتظهر أيقونة سيارة رمادية بدلاً من ذلك. هذا يجعل من الصعب التعرف على المركبات بصرياً.
    - **معلومات محدودة:** بطاقات عرض المركبات تفتقر إلى معلومات أساسية مثل "سعر الإيجار" أو "معلومات العقد الحالي" للمركبات المؤجرة.
    - **أيقونات غامضة:** تحتوي كل بطاقة على أيقونات ملونة صغيرة بدون أي نصوص توضيحية، مما يجعل معناها غير مفهوم.
- **مشاكل البيانات:**
    - **عدم اتساق الأسماء:** أسماء المركبات غير موحدة في طريقة الكتابة (مثال: `changan Alsvin` و `changan alsvin`).
    - **تناقض في الإحصائيات:** الإحصائيات في أعلى الصفحة تظهر "0 مركبة خارج الخدمة"، بينما تظهر مركبة واحدة بهذه الحالة في القائمة.
- **التحسينات المقترحة:**
    - **إصلاح عرض الصور:** يجب التأكد من رفع صور جميع المركبات وعرضها بشكل صحيح.
    - **إثراء بطاقات العرض:** يجب إضافة معلومات مهمة مثل سعر الإيجار ورابط للعقد الحالي.
    - **توضيح الأيقونات:** إضافة `tooltips` لشرح معنى كل أيقونة.
    - **توحيد البيانات:** يجب توحيد طريقة كتابة أسماء المركبات وإصلاح التناقض في الإحصائيات.

---


## 5. الخاتمة والتوصيات النهائية

بناءً على التحليل الشامل الذي تم إجراؤه، يتضح أن نظام Fleetify (Al-Araf) يعاني من مشاكل جوهرية تتطلب تدخلاً فورياً، خاصة في الجانب المالي. إن عدم تكامل البيانات، وتعطل الصفحات المالية الأساسية، ووجود أخطاء تقنية متكررة في جميع أنحاء النظام، كلها عوامل تحد من فعالية النظام وتقلل من قيمته كأداة لإدارة الأعمال.

### 5.1. خريطة طريق مقترحة للإصلاحات (Roadmap)

نوصي باتباع خريطة الطريق التالية لمعالجة المشاكل حسب الأولوية:

**المرحلة الأولى: الإصلاحات الحرجة (أسبوع واحد)**
1.  **إصلاح صفحة المدفوعات:** يجب أن يكون هذا هو الأولوية القصوى. لا يمكن للنظام أن يعمل بدون القدرة على تسجيل وتتبع المدفوعات.
2.  **إصلاح أخطاء الكونسول (400 & 406):** يجب تحديد وإصلاح جميع طلبات الـ API الفاشلة. هذا سيؤدي إلى تحسين استقرار وأداء النظام بشكل كبير.
3.  **تفعيل القيود المحاسبية:** يجب التأكد من أن جميع العمليات المالية (عقود، فواتير، مدفوعات) تقوم بإنشاء قيود محاسبية تلقائياً في دفتر الأستاذ.

**المرحلة الثانية: تكامل البيانات وتحسينات النظام المالي (أسبوعان)**
1.  **توحيد البيانات والعملة:** يجب مراجعة جميع وحدات النظام والتأكد من أنها تستخدم نفس مصدر البيانات ونفس العملة.
2.  **إدخال الأرصدة الافتتاحية:** تهيئة النظام محاسبياً بشكل صحيح.
3.  **إكمال صفحة التحليل المالي:** ربطها بالبيانات الحقيقية وإضافة الرسوم البيانية الأساسية.
4.  **تحسين صفحة التقارير المالية:** إضافة خاصية طي الحسابات وتصدير البيانات.

**المرحلة الثالثة: تحسينات تجربة المستخدم (مستمر)**
1.  **تحسين نماذج الإدخال:** تطبيق التحسينات المقترحة على نموذج إنشاء العقود وغيره.
2.  **تحسين عرض البيانات:** تطبيق التحسينات على صفحات العملاء وإدارة المركبات.
3.  **إضافة ميزات مساعدة:** إضافة `tooltips` وشروحات للميزات الغامضة.

### 5.2. توصيات عامة

- **اختبار شامل (QA):** يجب إجراء اختبار شامل للنظام بعد كل مرحلة من مراحل الإصلاح للتأكد من عدم ظهور مشاكل جديدة.
- **مراقبة الأداء (Monitoring):** يوصى باستخدام أدوات لمراقبة أداء النظام وتتبع الأخطاء في بيئة الإنتاج بشكل مستمر.
- **التوثيق:** يجب توثيق جميع التغييرات التي يتم إجراؤها على النظام لتسهيل الصيانة المستقبلية.

نأمل أن يكون هذا التقرير مفيداً في توجيه جهودكم لتحسين نظام Fleetify. نحن على استعداد لتقديم أي توضيحات إضافية قد تحتاجونها.
