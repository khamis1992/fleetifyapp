# ğŸ”„ Integrated Check-In/Check-Out Workflow

Visual guide showing how the integrated inspection system works.

---

## ğŸ“Š System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INTEGRATED INSPECTION SYSTEM                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                         â”‚
         â–¼                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IntegratedVehicle  â”‚                  â”‚  InspectionRemindersâ”‚
â”‚ Inspection.tsx     â”‚                  â”‚  .tsx               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Photo capture    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â€¢ Auto reminders   â”‚
â”‚ â€¢ Condition rating â”‚                  â”‚ â€¢ Status badges    â”‚
â”‚ â€¢ Comparison view  â”‚                  â”‚ â€¢ Pending list     â”‚
â”‚ â€¢ Signature        â”‚                  â”‚ â€¢ Toast alerts     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ useVehicle       â”‚
              â”‚ Inspections      â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ â€¢ Query data     â”‚
              â”‚ â€¢ Compare        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Supabase DB     â”‚
              â”‚  vehicle_        â”‚
              â”‚  inspections     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš¦ Check-In Workflow

```mermaid
graph TB
    A[Contract Created] --> B{Contract Activated?}
    B -->|No| C[Wait for Activation]
    B -->|Yes| D{Has Check-In Inspection?}
    D -->|Yes| E[Contract Active âœ…]
    D -->|No| F[ğŸ”´ Show Reminder Alert]
    
    F --> G[User Clicks 'ÙØ­Øµ Ø§Ù„Ø¢Ù†']
    G --> H[Open IntegratedVehicleInspection]
    H --> I[Fill Fuel Level]
    I --> J[Enter Odometer Reading]
    J --> K[Rate Cleanliness 1-5 â­]
    K --> L{Using Mobile?}
    
    L -->|Yes| M[ğŸ“¸ Open Camera]
    L -->|No| N[ğŸ“ Select from Gallery]
    
    M --> O[Capture Photos up to 10]
    N --> O
    
    O --> P[Document Damages]
    P --> Q[Add General Notes]
    Q --> R[Customer Signs âœï¸]
    R --> S{All Required Fields?}
    
    S -->|No| T[âŒ Show Validation Error]
    S -->|Yes| U[Upload Photos to Supabase]
    
    T --> H
    U --> V[Save Inspection to DB]
    V --> W[âœ… Check-In Complete]
    W --> E
```

---

## ğŸ”„ Check-Out Workflow

```mermaid
graph TB
    A[Contract Nearing End] --> B{Days Until End?}
    B -->|> 7 days| C[No Reminder]
    B -->|â‰¤ 7 days| D[âš ï¸ Show Warning Reminder]
    B -->|Ended| E[ğŸ”´ Show Urgent Reminder]
    
    D --> F[User Clicks 'ÙØ­Øµ Ø§Ù„Ø¢Ù†']
    E --> F
    
    F --> G[Open IntegratedVehicleInspection type='check_out']
    G --> H{Has Check-In Data?}
    
    H -->|No| I[âŒ Block Check-Out]
    H -->|Yes| J[Fetch Check-In Inspection]
    
    I --> K[Prompt to Do Check-In First]
    
    J --> L[Show Two Tabs]
    L --> M[Tab 1: Form Mode]
    L --> N[Tab 2: Comparison Mode]
    
    M --> O[Fill Current Values]
    N --> P[View Side-by-Side Comparison]
    
    P --> Q{Fuel Difference?}
    Q -->|< Check-In| R[ğŸ”´ Show Fuel Warning]
    Q -->|â‰¥ Check-In| S[Continue]
    R --> S
    
    S --> T{Odometer Difference?}
    T -->|> Check-In| U[âœ… Show Distance Traveled]
    T -->|â‰¤ Check-In| V[âŒ Invalid Reading]
    
    V --> O
    U --> W{Cleanliness Drop?}
    W -->|Yes| X[âš ï¸ Show Warning]
    W -->|No| Y[Continue]
    
    X --> Y
    Y --> Z[Capture New Photos ğŸ“¸]
    Z --> AA[Document New Damages]
    AA --> AB[Compare with Check-In Damages]
    AB --> AC[Customer Signs âœï¸]
    AC --> AD{Validation OK?}
    
    AD -->|No| AE[Show Errors]
    AD -->|Yes| AF[Upload Photos]
    
    AE --> O
    AF --> AG[Save Check-Out Inspection]
    AG --> AH[âœ… Check-Out Complete]
    AH --> AI[Contract Can Be Closed]
```

---

## ğŸ“± Mobile Photo Capture Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         MOBILE PHOTO CAPTURE                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                   â”‚
          â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Camera   â”‚      â”‚  Gallery     â”‚
    â”‚ Button   â”‚      â”‚  Button      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚
          â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Opens    â”‚      â”‚ Opens File   â”‚
    â”‚ Native   â”‚      â”‚ Picker       â”‚
    â”‚ Camera   â”‚      â”‚ (Multi)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Preview Images   â”‚
          â”‚ (2-4 columns)    â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ User Actions:    â”‚
          â”‚ â€¢ View full size â”‚
          â”‚ â€¢ Remove photo   â”‚
          â”‚ â€¢ Add more (10x) â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ On Submit:       â”‚
          â”‚ Upload to        â”‚
          â”‚ Supabase Storage â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Store URLs in    â”‚
          â”‚ photo_urls[]     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Comparison View Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMPARISON MODE (Check-Out Only)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ğŸ›¢ï¸ Fuel     â”‚    â”‚ â±ï¸ Odometer â”‚    â”‚ âœ¨ Clean    â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚ Check-In:  â”‚    â”‚ Check-In:  â”‚    â”‚ Check-In:  â”‚       â”‚
â”‚  â”‚   100%     â”‚    â”‚  50,000 km â”‚    â”‚  â­â­â­â­â­    â”‚       â”‚
â”‚  â”‚            â”‚    â”‚            â”‚    â”‚            â”‚       â”‚
â”‚  â”‚ Current:   â”‚    â”‚ Current:   â”‚    â”‚ Current:   â”‚       â”‚
â”‚  â”‚   75%      â”‚    â”‚  52,450 km â”‚    â”‚  â­â­â­      â”‚       â”‚
â”‚  â”‚            â”‚    â”‚            â”‚    â”‚            â”‚       â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚       â”‚
â”‚  â”‚ Diff:      â”‚    â”‚ Distance:  â”‚    â”‚ Diff:      â”‚       â”‚
â”‚  â”‚ -25% ğŸ”´    â”‚    â”‚ 2,450 km   â”‚    â”‚ -2 â­ ğŸ”´    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ”§ Damages Recorded at Check-In                      â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â€¢ [Minor] Ø®Ø¯Ø´ Ø¨Ø³ÙŠØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ Ø§Ù„Ø£ÙŠÙ…Ù†          â”‚  â”‚
â”‚  â”‚ â€¢ [Moderate] ÙƒØ³Ø± ÙÙŠ Ø§Ù„Ù…Ø±Ø¢Ø© Ø§Ù„ÙŠØ³Ø±Ù‰                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“¸ Check-In Photos                                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  [img1] [img2] [img3] [img4]                         â”‚  â”‚
â”‚  â”‚  [img5] [img6] [img7] [img8]                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## â° Reminder Timeline

```
Contract Lifecycle:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º

Created          Activated         7 Days Left      Ended
   â”‚                â”‚                   â”‚              â”‚
   â”‚                â–¼                   â”‚              â”‚
   â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚              â”‚
   â”‚        â”‚ ğŸ”´ CHECK-IN    â”‚           â”‚              â”‚
   â”‚        â”‚   REMINDER     â”‚           â”‚              â”‚
   â”‚        â”‚   (Urgent)     â”‚           â”‚              â”‚
   â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚              â”‚
   â”‚                                    â”‚              â”‚
   â”‚                                    â–¼              â”‚
   â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
   â”‚                            â”‚ âš ï¸ CHECK-OUT   â”‚      â”‚
   â”‚                            â”‚   REMINDER     â”‚      â”‚
   â”‚                            â”‚   (Warning)    â”‚      â”‚
   â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
   â”‚                                                   â”‚
   â”‚                                                   â–¼
   â”‚                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                           â”‚ ğŸ”´ CHECK-OUT   â”‚
   â”‚                                           â”‚   OVERDUE      â”‚
   â”‚                                           â”‚   (Urgent)     â”‚
   â”‚                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
ğŸ”´ Red Alert (Urgent, persistent)
âš ï¸ Yellow Warning (Important)
âœ… Green Success (Completed)
```

---

## ğŸ’¾ Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User       â”‚
â”‚   Actions    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IntegratedVehicleInspection  â”‚
â”‚ Component State:             â”‚
â”‚ â€¢ fuelLevel                  â”‚
â”‚ â€¢ odometerReading            â”‚
â”‚ â€¢ cleanlinessRating          â”‚
â”‚ â€¢ photos[]                   â”‚
â”‚ â€¢ damageNotes                â”‚
â”‚ â€¢ customerSignature          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useCreateInspection Hook     â”‚
â”‚ â€¢ Validate inputs            â”‚
â”‚ â€¢ Upload photos              â”‚
â”‚ â€¢ Generate photo URLs        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Storage API         â”‚
â”‚ Bucket: vehicle-documents    â”‚
â”‚ Path: {company}/{contract}/  â”‚
â”‚       {type}/{timestamp}.jpg â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Returns photo URLs
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Database            â”‚
â”‚ Table: vehicle_inspections   â”‚
â”‚ INSERT:                      â”‚
â”‚ {                            â”‚
â”‚   contract_id,               â”‚
â”‚   vehicle_id,                â”‚
â”‚   inspection_type,           â”‚
â”‚   fuel_level,                â”‚
â”‚   odometer_reading,          â”‚
â”‚   cleanliness_rating,        â”‚
â”‚   exterior_condition: [...], â”‚
â”‚   photo_urls: [url1, ...],   â”‚
â”‚   customer_signature,        â”‚
â”‚   ...                        â”‚
â”‚ }                            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ React Query Cache Update     â”‚
â”‚ â€¢ Invalidate queries         â”‚
â”‚ â€¢ Trigger re-fetch           â”‚
â”‚ â€¢ Update UI                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UI Updates:                  â”‚
â”‚ â€¢ Hide reminder alert        â”‚
â”‚ â€¢ Show success toast         â”‚
â”‚ â€¢ Update status badge        â”‚
â”‚ â€¢ Close dialog               â”‚
â”‚ â€¢ Refresh contract data      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ User Journey Map

### Check-In Journey

```
1. Contract Created
   â””â”€â–º User sees contract in "Draft" status

2. User Activates Contract
   â””â”€â–º System checks: Has check-in inspection?
       â”œâ”€â–º Yes: âœ… Activate immediately
       â””â”€â–º No:  ğŸ”´ Block activation, show reminder

3. User Sees Reminder
   â””â”€â–º Red alert: "ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ÙØ­Øµ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹"
       â””â”€â–º Button: "ÙØ­Øµ Ø§Ù„Ø¢Ù†"

4. User Clicks "ÙØ­Øµ Ø§Ù„Ø¢Ù†"
   â””â”€â–º Dialog opens with IntegratedVehicleInspection

5. User Fills Inspection
   â”œâ”€â–º Fuel: Slide to 100%
   â”œâ”€â–º Odometer: Type 50,000
   â”œâ”€â–º Cleanliness: Click 5 stars
   â”œâ”€â–º Photos: Tap camera ğŸ“¸ â†’ Take 6 photos
   â”œâ”€â–º Damages: Type any damages
   â””â”€â–º Signature: Customer signs âœï¸

6. User Submits
   â””â”€â–º System validates
       â”œâ”€â–º Missing signature? âŒ Error
       â”œâ”€â–º No photos? âŒ Error
       â”œâ”€â–º Odometer = 0? âŒ Error
       â””â”€â–º All good? âœ… Upload & Save

7. Inspection Saved
   â””â”€â–º âœ… Success toast
       â””â”€â–º Dialog closes
           â””â”€â–º Reminder disappears
               â””â”€â–º Contract can now be activated
```

### Check-Out Journey

```
1. Contract Active
   â””â”€â–º 7 days before end date
       â””â”€â–º âš ï¸ Warning reminder appears

2. User Sees Reminder
   â””â”€â–º Yellow alert: "Ø§Ù„Ø¹Ù‚Ø¯ Ø³ÙŠÙ†ØªÙ‡ÙŠ Ø®Ù„Ø§Ù„ X Ø£ÙŠØ§Ù…"
       â””â”€â–º Button: "ÙØ­Øµ Ø§Ù„Ø¢Ù†"

3. User Clicks "ÙØ­Øµ Ø§Ù„Ø¢Ù†"
   â””â”€â–º Dialog opens with IntegratedVehicleInspection type="check_out"
       â””â”€â–º System fetches check-in data

4. User Sees Comparison Tab
   â””â”€â–º Toggle between "Form" and "Comparison"
       â”œâ”€â–º Form: Fill current values
       â””â”€â–º Comparison: See check-in vs current

5. User Fills Check-Out
   â”œâ”€â–º Fuel: 75% (system shows: -25% from check-in ğŸ”´)
   â”œâ”€â–º Odometer: 52,450 (system shows: +2,450 km traveled)
   â”œâ”€â–º Cleanliness: 3 stars (system shows: -2 stars ğŸ”´)
   â”œâ”€â–º Photos: Take 8 new photos
   â”œâ”€â–º Damages: Document any new damages
   â””â”€â–º Signature: Customer signs

6. User Reviews Comparison
   â””â”€â–º See all differences highlighted
       â”œâ”€â–º Fuel drop: Charge refuel fee?
       â”œâ”€â–º Distance: Normal usage
       â””â”€â–º Cleanliness drop: Charge cleaning fee?

7. User Submits
   â””â”€â–º System validates & saves
       â””â”€â–º âœ… Check-out complete
           â””â”€â–º Contract can be closed
```

---

## ğŸ” Permission Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Authentication                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Company Access Check               â”‚
â”‚  (useUnifiedCompanyAccess)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Database RLS Policies              â”‚
â”‚  â€¢ User can only see own company    â”‚
â”‚  â€¢ User can create inspections      â”‚
â”‚  â€¢ User can view own inspections    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Storage Policies                   â”‚
â”‚  â€¢ Authenticated users can upload   â”‚
â”‚  â€¢ Company-specific folders         â”‚
â”‚  â€¢ Public read access               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Database Schema Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ vehicle_inspections                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: UUID (PK)                        â”‚
â”‚ company_id: UUID (FK â†’ companies)    â”‚
â”‚ contract_id: UUID (FK â†’ contracts)   â”‚
â”‚ vehicle_id: UUID (FK â†’ vehicles)     â”‚
â”‚ inspection_type: ENUM                â”‚
â”‚   â€¢ 'check_in'                       â”‚
â”‚   â€¢ 'check_out'                      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Measurements:                        â”‚
â”‚ â€¢ fuel_level: INT (0-100)            â”‚
â”‚ â€¢ odometer_reading: INT (km)         â”‚
â”‚ â€¢ cleanliness_rating: INT (1-5)      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Condition:                           â”‚
â”‚ â€¢ exterior_condition: JSONB[]        â”‚
â”‚ â€¢ interior_condition: JSONB[]        â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Evidence:                            â”‚
â”‚ â€¢ photo_urls: TEXT[]                 â”‚
â”‚ â€¢ customer_signature: TEXT           â”‚
â”‚ â€¢ notes: TEXT                        â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Metadata:                            â”‚
â”‚ â€¢ inspected_by: UUID (FK â†’ profiles) â”‚
â”‚ â€¢ inspection_date: TIMESTAMP         â”‚
â”‚ â€¢ created_at: TIMESTAMP              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€â”€â–º Indexes:
          â”‚    â€¢ company_id
          â”‚    â€¢ contract_id
          â”‚    â€¢ vehicle_id
          â”‚    â€¢ inspection_type
          â”‚
          â””â”€â”€â–º RLS Policies:
               â€¢ SELECT: Own company only
               â€¢ INSERT: Authenticated users
               â€¢ UPDATE: Own company only
```

---

**Ready to implement!** Follow this workflow to understand how all pieces work together. ğŸš€
