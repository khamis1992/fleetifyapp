# โ ุฅุตูุงุญ ุฒุฑ ุฅุฑุณุงู ุงูุชูุจููุงุช ูู ุตูุญุฉ ุงูุนููุฏ

## ๐ ุงูุชุงุฑูุฎ
2 ููููุจุฑ 2025

## ๐ ุงููุดููุฉ

ุฒุฑ "ุฅุฑุณุงู ุชูุจููุงุช" ูู ุตูุญุฉ ุงูุนููุฏ ูุงู ููุฌู ุงููุณุชุฎุฏู ููุท ุฅูู ุตูุญุฉ `/collections` ุฏูู ุชูููุฐ ุฃู ูุธููุฉ ูุนููุฉ ูุฅุฑุณุงู ุงูุชูุจููุงุช.

```typescript
// ูุจู (ูุง ูุนูู):
<Button onClick={() => navigate('/collections')}>
  ุฅุฑุณุงู ุชูุจููุงุช
</Button>
```

## โ ุงูุญู

ุชู ุฅูุดุงุก ูุธุงู ูุชูุงูู ูุฅุฑุณุงู ุงูุชูุจููุงุช ูุจุงุดุฑุฉ ูู ุตูุญุฉ ุงูุนููุฏ:

### 1. Dialog ูุชูุฏู (`SendRemindersDialog`)
### 2. Hook ูุฅุฑุณุงู ุงูุชูุจููุงุช (`useSendManualReminders`)
### 3. ุชุญุฏูุซ ุตูุญุฉ ุงูุนููุฏ

## ๐ ุงููููุงุช ุงููุถุงูุฉ/ุงููุญุฏุซุฉ

### 1. Dialog Component (ุฌุฏูุฏ)
**ุงูููู:** `src/components/contracts/SendRemindersDialog.tsx`

**ุงููููุฒุงุช:**
- โ ูุงุฌูุฉ ุณููุฉ ุงูุงุณุชุฎุฏุงู
- โ ุงุฎุชูุงุฑ ููุน ุงูุชุฐููุฑ (5 ุฃููุงุน)
- โ ุฑุณุงูุฉ ูุฎุตุตุฉ ุงุฎุชูุงุฑูุฉ
- โ ุงุฎุชูุงุฑ ุนููุฏ ูุชุนุฏุฏุฉ
- โ ููุชุฑุฉ ุชููุงุฆูุฉ (ููุท ุงูุนููุฏ ุงููุดุทุฉ ูุน ุฃุฑูุงู ููุงุชู)
- โ ุฅุญุตุงุฆูุงุช ููุฑูุฉ (ูุคููุ ูุญุฏุฏุ ูุชุจูู)
- โ ุชุตููู ุงุญุชุฑุงูู ูุน ุฃููููุงุช

**ุฃููุงุน ุงูุชุฐููุฑุงุช:**
1. **ุชุฐููุฑ ุนุงู** - ุฑุณุงูุฉ ุนุงูุฉ ููุนููู
2. **ุชุฐููุฑ ูุณุจู** - ูุจู ููุนุฏ ุงูุงุณุชุญูุงู
3. **ููู ุงูุงุณุชุญูุงู** - ุชุฐููุฑ ุจููุนุฏ ุงูุฏูุน
4. **ูุชุฃุฎุฑ** - ุชูุจูู ุจุชุฃุฎุฑ ุงูุฏูุน
5. **ุฅูุฐุงุฑ ููุงุฆู** - ุชุญุฐูุฑ ูุจู ุงูุฅุฌุฑุงุกุงุช ุงููุงููููุฉ

### 2. Hook for Manual Reminders (ุฌุฏูุฏ)
**ุงูููู:** `src/hooks/useSendManualReminders.ts`

**ุงููุธุงุฆู:**
- โ ุฅุฑุณุงู ุชูุจููุงุช ูุนููุฏ ูุญุฏุฏุฉ
- โ ุงูุจุญุซ ุนู ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ
- โ ุฅูุดุงุก reminder_schedules ุชููุงุฆูุงู
- โ ุฏุนู ุงูููุงูุจ ุงูุฌุงูุฒุฉ ุฃู ุฑุณุงุฆู ูุฎุตุตุฉ
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงููุฌุงุญ
- โ Toast notifications ููุญุงูุงุช ุงููุฎุชููุฉ

**ุงูุชูููุน:**
```typescript
interface SendManualRemindersParams {
  contracts: Contract[];
  reminderType?: 'pre_due' | 'due_date' | 'overdue' | 'escalation' | 'general';
  customMessage?: string;
}

const sendReminders = useSendManualReminders();
await sendReminders.mutateAsync({
  contracts: [...],
  reminderType: 'general',
  customMessage: 'ุฑุณุงูุชู ุงููุฎุตุตุฉ'
});
```

### 3. Contracts Page Update (ูุญุฏุซ)
**ุงูููู:** `src/pages/Contracts.tsx`

**ุงูุชุบููุฑุงุช:**
```typescript
// 1. Import Dialog
import SendRemindersDialog from "@/components/contracts/SendRemindersDialog";

// 2. Add state
const [showRemindersDialog, setShowRemindersDialog] = useState(false);

// 3. Update button
<Button onClick={() => setShowRemindersDialog(true)}>
  ุฅุฑุณุงู ุชูุจููุงุช
</Button>

// 4. Add dialog
<SendRemindersDialog 
  open={showRemindersDialog} 
  onOpenChange={setShowRemindersDialog}
  contracts={data || []}
/>
```

## ๐ฏ ููู ูุนูู ุงููุธุงู ุงูุขู

### ุณูุฑ ุงูุนูู:

```
1. ุงููุณุชุฎุฏู ููุชุญ ุตูุญุฉ ุงูุนููุฏ
   โ
2. ูุถุบุท ุนูู ุฒุฑ "ุฅุฑุณุงู ุชูุจููุงุช" 
   โ
3. ููุชุญ Dialog ูุชูุฏู ูุนุฑุถ:
   - ุฅุญุตุงุฆูุงุช (ุนุฏุฏ ุงูุนููุฏ ุงููุคููุฉ)
   - ุฃููุงุน ุงูุชุฐููุฑุงุช (5 ุฎูุงุฑุงุช)
   - ูุงุฆูุฉ ุงูุนููุฏ ููุงุฎุชูุงุฑ
   - ุญูู ุฑุณุงูุฉ ูุฎุตุตุฉ
   โ
4. ูุฎุชุงุฑ ุงููุณุชุฎุฏู:
   - ููุน ุงูุชุฐููุฑ
   - ุงูุนููุฏ ุงููุทููุจุฉ
   - ุฑุณุงูุฉ ูุฎุตุตุฉ (ุงุฎุชูุงุฑู)
   โ
5. ูุถุบุท "ุฅุฑุณุงู"
   โ
6. Hook ูููู ุจู:
   - ุฌูุจ ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ
   - ุงูุชุญูู ูู ุฃุฑูุงู ุงูููุงุชู
   - ุฅูุดุงุก reminder_schedules
   - ุฌุฏููุฉ ุงูุฅุฑุณุงู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
   โ
7. ุนุฑุถ ูุชูุฌุฉ:
   - ุฑุณุงูุฉ ูุฌุงุญ ูุน ุงูุนุฏุฏ
   - ุฑุณุงูุฉ ุชุญุฐูุฑ ูููุงุดูุฉ (ุฅู ูุฌุฏุช)
```

## ๐ฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### Dialog Layout:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ฌ ุฅุฑุณุงู ุชูุจููุงุช ูุงุชุณุงุจ                  [X]   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ โน๏ธ ุณูุชู ุฅุฑุณุงู ุงูุชูุจููุงุช ููุฑุงู ููุนููุฏ ุงููุญุฏุฏุฉ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ  โโโโโโโโโโ  โโโโโโโโโโ  โโโโโโโโโโ              โ
โ  โ ๐ฅ 25  โ  โ โ 10  โ  โ ๐ฌ 15  โ              โ
โ  โ ูุคูู   โ  โ ูุญุฏุฏ   โ  โ ูุชุจูู  โ              โ
โ  โโโโโโโโโโ  โโโโโโโโโโ  โโโโโโโโโโ              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ  ููุน ุงูุชุฐููุฑ:                                    โ
โ  โ ุชุฐููุฑ ุนุงู       โ ุชุฐููุฑ ูุณุจู                 โ
โ  โ ููู ุงูุงุณุชุญูุงู   โ ูุชุฃุฎุฑ                      โ
โ  โ ุฅูุฐุงุฑ ููุงุฆู                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ  ุฑุณุงูุฉ ูุฎุตุตุฉ (ุงุฎุชูุงุฑู):                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โ [ูุต ุงูุฑุณุงูุฉ...]                         โ     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  0/1000 ุญุฑู                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ  ุงุฎุชุฑ ุงูุนููุฏ (25)              [ุชุญุฏูุฏ ุงููู]      โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โ โ #2025-001 - ุฃุญูุฏ ูุญูุฏ   ๐ฑ +965...    โ     โ
โ  โ โ #2025-002 - ูุงุทูุฉ ุนูู   ๐ฑ +965...    โ     โ
โ  โ โ #2025-003 - ุฎุงูุฏ ุณุนูุฏ   ๐ฑ +965...    โ     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ                        [ุฅูุบุงุก]  [๐ค ุฅุฑุณุงู (10)] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ุงูููุงูุจ ุงูุงูุชุฑุงุถูุฉ ููุฑุณุงุฆู

### 1. ุชุฐููุฑ ุนุงู
```
ูุฑุญุจุงู [ุงุณู ุงูุนููู] ๐

ุชุฐููุฑ: ุนูุฏู ุฑูู [ุฑูู ุงูุนูุฏ] ูุญุชุงุฌ ูุชุงุจุนุฉ.

ููุงุณุชูุณุงุฑ ุชูุงุตู ูุนูุง. ุดูุฑุงู ๐
```

### 2. ุชุฐููุฑ ูุณุจู
```
ูุฑุญุจุงู [ุงุณู ุงูุนููู] ๐

ุชุฐููุฑ ูุฏู: ูุงุชูุฑุชู ุฑูู [ุฑูู ุงููุงุชูุฑุฉ] ุจูุจูุบ [ุงููุจูุบ] ุฏ.ู ุณุชุณุชุญู ูุฑูุจุงู.

ุดูุฑุงู ูุชุนุงูููู ๐
```

### 3. ููู ุงูุงุณุชุญูุงู
```
ุนุฒูุฒู ุงูุนููู [ุงุณู ุงูุนููู] ๐

ุชุฐููุฑ: ูุงุชูุฑุชู ุฑูู [ุฑูู ุงููุงุชูุฑุฉ] ุจูุจูุบ [ุงููุจูุบ] ุฏ.ู ูุณุชุญูุฉ ุงูููู.

ูุฃูู ุณุฑุนุฉ ุงูุณุฏุงุฏ. ุดูุฑุงู ๐
```

### 4. ูุชุฃุฎุฑ
```
ุนุฒูุฒู ุงูุนููู [ุงุณู ุงูุนููู] โ๏ธ

ุชูุจูู ูุงู: ูุงุชูุฑุชู ุฑูู [ุฑูู ุงููุงุชูุฑุฉ] ูุชุฃุฎุฑุฉ. 
ุงููุจูุบ: [ุงููุจูุบ] ุฏ.ู + ุบุฑุงูุงุช ุงูุชุฃุฎูุฑ.

ูุฑุฌู ุงูุณุฏุงุฏ ููุฑุงู ูุชุฌูุจ ุงูุฅุฌุฑุงุกุงุช ุงููุงููููุฉ. ๐จ
```

### 5. ุฅูุฐุงุฑ ููุงุฆู
```
ุนุฒูุฒู ุงูุนููู [ุงุณู ุงูุนููู] ๐จ

ุฅูุฐุงุฑ ููุงุฆู: ูุงุชูุฑุชู ุฑูู [ุฑูู ุงููุงุชูุฑุฉ] ูุชุฃุฎุฑุฉ ุจุดูู ูุจูุฑ.

ุณูุชู ุงุชุฎุงุฐ ุฅุฌุฑุงุกุงุช ูุงููููุฉ ุฎูุงู 48 ุณุงุนุฉ ูู ุญุงูุฉ ุนุฏู ุงูุณุฏุงุฏ.

ุงููุจูุบ ุงููุณุชุญู: [ุงููุจูุบ] ุฏ.ู
```

## ๐ง ุงูุชูุงุตูู ุงููููุฉ

### ุงูุฎูุงุฑุฒููุฉ:

1. **ููุชุฑุฉ ุงูุนููุฏ:**
   - ููุท ุงูุนููุฏ ุงููุดุทุฉ (status = 'active')
   - ููุท ุงูุนููุฏ ูุน ุฃุฑูุงู ููุงุชู
   ```typescript
   eligibleContracts = contracts.filter(c => 
     c.customer_phone && c.status === 'active'
   )
   ```

2. **ุฌูุจ ุงูููุงุชูุฑ:**
   - ุงูุจุญุซ ุนู ูุงุชูุฑุฉ ุบูุฑ ูุฏููุนุฉ ููู ุนูุฏ
   - ุชุฑุชูุจ ุจุงูุฃุญุฏุซ ุฃููุงู
   ```sql
   SELECT * FROM invoices 
   WHERE contract_id = X 
   AND payment_status = 'unpaid'
   ORDER BY created_at DESC
   LIMIT 1
   ```

3. **ุฅูุดุงุก Reminders:**
   - ุฅุถุงูุฉ ุณุฌู ูู `reminder_schedules`
   - ุงูุญุงูุฉ: 'queued' (ุฌุงูุฒ ููุฅุฑุณุงู)
   - sent_by: ูุนุฑู ุงููุณุชุฎุฏู ุงูุญุงูู
   ```typescript
   INSERT INTO reminder_schedules {
     company_id,
     invoice_id,
     customer_id,
     reminder_type,
     phone_number,
     message_template,
     status: 'queued'
   }
   ```

4. **ุงููุนุงูุฌุฉ:**
   - Cron job ูุนูู ููููุงู
   - ูุฌูุจ reminders ุจุญุงูุฉ 'queued'
   - ูุฑุณููุง ุนุจุฑ WhatsApp Web service
   - ูุญุฏุซ ุงูุญุงูุฉ ุฅูู 'sent'

## ๐จ ุงูุชุตููู

### ุงูุฃููุงู:
- **Purple/ุจููุณุฌู:** ุงูููู ุงูุฃุณุงุณู ููุชูุจููุงุช
- **Green/ุฃุฎุถุฑ:** ุชุฐููุฑ ูุณุจู (ูุฏู)
- **Blue/ุฃุฒุฑู:** ุชุฐููุฑ ุนุงู
- **Yellow/ุฃุตูุฑ:** ููู ุงูุงุณุชุญูุงู
- **Orange/ุจุฑุชูุงูู:** ูุชุฃุฎุฑ
- **Red/ุฃุญูุฑ:** ุฅูุฐุงุฑ ููุงุฆู

### ุงูููููุงุช:
- **Cards** ููู ููุน ุชุฐููุฑ
- **Badges** ูุฃุฑูุงู ุงูููุงุชู
- **Checkboxes** ูุงุฎุชูุงุฑ ุงูุนููุฏ
- **Alert** ููุชูุจููุงุช
- **Statistics Cards** ููุฅุญุตุงุฆูุงุช

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุนุฑูุถุฉ

### ูู Dialog:
1. **ุนููุฏ ูุคููุฉ:** ุนุฏุฏ ุงูุนููุฏ ุงููุดุทุฉ ูุน ุฃุฑูุงู ููุงุชู
2. **ูุญุฏุฏ:** ุนุฏุฏ ุงูุนููุฏ ุงููุฎุชุงุฑุฉ
3. **ูุชุจูู:** ุงููุฑู ุจูู ุงููุคูู ูุงููุญุฏุฏ

### ุจุนุฏ ุงูุฅุฑุณุงู:
```
โ ุชู ุฌุฏููุฉ 10 ุชุฐููุฑ ุจูุฌุงุญ
ุณูุชู ุฅุฑุณุงู ุงูุชุฐููุฑุงุช ุนุจุฑ ูุงุชุณุงุจ ูุฑูุจุงู

โ๏ธ ูุดู 2 ูู 12
ุจุนุถ ุงูุนููุฏ ูุง ุชุญุชูู ุนูู ููุงุชูุฑ ุฃู ุฃุฑูุงู ููุงุชู
```

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูู ุตูุญุฉ ุงูุนููุฏ:

1. **ุงูุชุญ ุตูุญุฉ ุงูุนููุฏ**
   ```
   Dashboard โ ุนููุฏ ุงูุฅูุฌุงุฑ
   ```

2. **ุงุถุบุท ุฒุฑ "ุฅุฑุณุงู ุชูุจููุงุช"**
   - ุงูุฒุฑ ุงูุจููุณุฌู ูู ุงูุฃุนูู
   - ุฃููููุฉ ุฑุณุงูุฉ (๐ฌ)

3. **ูู Dialog:**
   - ุงุฎุชุฑ ููุน ุงูุชุฐููุฑ
   - (ุงุฎุชูุงุฑู) ุฃุฏุฎู ุฑุณุงูุฉ ูุฎุตุตุฉ
   - ุญุฏุฏ ุงูุนููุฏ ุงููุทููุจุฉ
   - ุฃู ุงุถุบุท "ุชุญุฏูุฏ ุงููู"

4. **ุงุถุบุท "ุฅุฑุณุงู"**
   - ุณุชุฑู spinner ุฃุซูุงุก ุงููุนุงูุฌุฉ
   - ุฑุณุงูุฉ ูุฌุงุญ ุนูุฏ ุงูุงูุชูุงุก

5. **ุงููุชูุฌุฉ:**
   - ุงูุชูุจููุงุช ุชูุถุงู ููุงุฆูุฉ ุงูุงูุชุธุงุฑ
   - ุณูุชู ุฅุฑุณุงููุง ุนุจุฑ WhatsApp service
   - ุชุญุฏูุซ ุชููุงุฆู ููุจูุงูุงุช

## โ๏ธ ุงููุชุทูุจุงุช

### ูุงุนุฏุฉ ุงูุจูุงูุงุช:
ูุฌุจ ุชุดุบูู migration ุงูุชูุจููุงุช:
```sql
supabase/migrations/20250126130000_create_whatsapp_reminders.sql
```

### ุงูุฌุฏุงูู ุงููุณุชุฎุฏูุฉ:
1. `reminder_schedules` - ุฌุฏููุฉ ุงูุชูุจููุงุช
2. `reminder_history` - ุณุฌู ุงูุฅุฑุณุงู
3. `invoices` - ุงูููุงุชูุฑ
4. `customers` - ุจูุงูุงุช ุงูุนููุงุก
5. `contracts` - ุงูุนููุฏ

### WhatsApp Service:
ูุฅุฑุณุงู ุงูุฑุณุงุฆู ูุนููุงูุ ูุฌุจ ุชุดุบูู:
```bash
node services/whatsapp-reminder-service.js
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "ูุง ุชูุฌุฏ ุนููุฏ ูุดุทุฉ"
**ุงูุญู:** ุชุฃูุฏ ูู:
- ูุฌูุฏ ุนููุฏ ุจุญุงูุฉ 'active'
- ุงูุนููุงุก ูุฏููู ุฃุฑูุงู ููุงุชู
- ุงูููุงุชูุฑ ููุฌูุฏุฉ ูุบูุฑ ูุฏููุนุฉ

### ุงููุดููุฉ: "ูุดู ุงูุฅุฑุณุงู"
**ุงูุญู:** ุชุญูู ูู:
- migration ุงูุชูุจููุงุช ุชู ุชูููุฐูุง
- ุฌุฏูู reminder_schedules ููุฌูุฏ
- ุฃุฑูุงู ุงูููุงุชู ุตุญูุญุฉ

### ุงููุดููุฉ: "ูุง ูุชู ุฅุฑุณุงู ุงูุฑุณุงุฆู"
**ุงูุญู:** ุชุฃูุฏ ูู:
- WhatsApp service ูุนูู
- ุงูุงุชุตุงู ุจูุงุชุณุงุจ ููุจ ูุดุท
- Cron job ูุนูู ููููุงู

## ๐ ุงูุชุญุณููุงุช

### ูุจู:
- โ ุฒุฑ ููุฌู ูุตูุญุฉ ุฃุฎุฑู ููุท
- โ ูุง ุชูุฌุฏ ูุธููุฉ ุฅุฑุณุงู
- โ ูุง ูููู ุงุฎุชูุงุฑ ุนููุฏ ูุญุฏุฏุฉ
- โ ูุง ูููู ุชุฎุตูุต ุงูุฑุณุงุฆู

### ุจุนุฏ:
- โ Dialog ูุชูุฏู ููุจุงุดุฑ
- โ ุฅุฑุณุงู ููุฑู ูู ููุณ ุงูุตูุญุฉ
- โ ุงุฎุชูุงุฑ ุนููุฏ ูุชุนุฏุฏุฉ
- โ 5 ุฃููุงุน ูู ุงูุชุฐููุฑุงุช
- โ ุฑุณุงุฆู ูุฎุตุตุฉ
- โ ุฅุญุตุงุฆูุงุช ููุฑูุฉ
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ
- โ Toast notifications

## โ ุงูุฎูุงุตุฉ

ุชู ุจูุฌุงุญ:
1. โ ุฅูุดุงุก `SendRemindersDialog` component
2. โ ุฅูุดุงุก `useSendManualReminders` hook
3. โ ุชุญุฏูุซ ุตูุญุฉ Contracts ูุงุณุชุฎุฏุงู Dialog
4. โ ุฏุนู 5 ุฃููุงุน ูู ุงูุชุฐููุฑุงุช
5. โ ุฏุนู ุงูุฑุณุงุฆู ุงููุฎุตุตุฉ
6. โ ููุชุฑุฉ ุชููุงุฆูุฉ ููุนููุฏ ุงููุคููุฉ
7. โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงููุฌุงุญ
8. โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก linter

---

**ุชู ุงูุชูููุฐ ุจูุงุณุทุฉ:** AI Assistant  
**ุงูุชุงุฑูุฎ:** 2 ููููุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ููุชูู ูููุฎุชุจุฑ

