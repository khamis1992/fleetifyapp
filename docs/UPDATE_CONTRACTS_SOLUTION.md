# ุชุญุฏูุซ ุญุงูุฉ ุนููุฏ ุดุฑูุฉ ุงูุนุฑุงู - ุฏููู ุงูุชูููุฐ

## โ ุงููุดููุฉ ุงูููุชุดูุฉ

ุนูุฏ ูุญุงููุฉ ุชูููุฐ ุงูุณูุฑูุจุชุ ุชุจูู ุฃู Row Level Security (RLS) ูููุน ุงููุตูู ุงููุจุงุดุฑ ููุจูุงูุงุช.

## โ ุงูุญููู ุงููุชุงุญุฉ

### ุงูุญู 1: ุงุณุชุฎุฏุงู Supabase Dashboard (ุงูููุตู ุจู)

1. **ุงูุชุญ Supabase Dashboard**
   - ุงุฐูุจ ุฅูู: https://supabase.com/dashboard
   - ุงุฎุชุฑ ุงููุดุฑูุน: Fleetify

2. **ุงูุชุญ SQL Editor**
   - ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ โ SQL Editor
   - ุงุถุบุท "New query"

3. **ููุฐ ูุฐุง ุงูุงุณุชุนูุงู**:

```sql
-- ุงูุชุญูู ุฃููุงู ูู ุนุฏุฏ ุงูุนููุฏ
SELECT 
    COUNT(*) as total_under_review
FROM contracts
WHERE company_id = '24bc0b21-4e2d-4413-9842-31719a3669f4'
  AND status = 'under_review';

-- ุฅุฐุง ูุงู ุงูุนุฏุฏ 409 ููุง ูุชููุนุ ููุฐ ุงูุชุญุฏูุซ:
UPDATE contracts
SET 
    status = 'cancelled',
    updated_at = NOW()
WHERE company_id = '24bc0b21-4e2d-4413-9842-31719a3669f4'
  AND status = 'under_review';

-- ุงูุชุญูู ูู ุงููุชูุฌุฉ
SELECT 
    status,
    COUNT(*) as count
FROM contracts
WHERE company_id = '24bc0b21-4e2d-4413-9842-31719a3669f4'
GROUP BY status
ORDER BY count DESC;
```

### ุงูุญู 2: ูู ุฏุงุฎู ุงูุชุทุจูู (ุจุงุณุชุฎุฏุงู ุญุณุงุจ ูุตุงุฏู)

ุฅุฐุง ููุช ุชุฑูุฏ ุงูุชูููุฐ ูู ุฏุงุฎู ุงูุชุทุจูู:

1. **ุณุฌู ุฏุฎููู** ูู ุงูุชุทุจูู
2. **ุงูุชุญ Developer Tools** (F12)
3. **ุงุฐูุจ ุฅูู Console**
4. **ููุฐ ูุฐุง ุงูููุฏ**:

```javascript
// ุชุญุฏูุซ ุงูุนููุฏ
const { supabase } = await import('/src/integrations/supabase/client');

const AL_ARRAF_ID = '24bc0b21-4e2d-4413-9842-31719a3669f4';

// ุนุฏ ุงูุนููุฏ ุฃููุงู
const { count } = await supabase
  .from('contracts')
  .select('*', { count: 'exact', head: true })
  .eq('company_id', AL_ARRAF_ID)
  .eq('status', 'under_review');

console.log(`ุนุฏุฏ ุงูุนููุฏ: ${count}`);

// ุฅุฐุง ูุงู ุงูุนุฏุฏ ุตุญูุญุ ููุฐ ุงูุชุญุฏูุซ
if (count > 0) {
  const { data, error } = await supabase
    .from('contracts')
    .update({ status: 'cancelled' })
    .eq('company_id', AL_ARRAF_ID)
    .eq('status', 'under_review')
    .select();
  
  console.log(`ุชู ุชุญุฏูุซ ${data?.length} ุนูุฏ`);
}
```

### ุงูุญู 3: ุงุณุชุฎุฏุงู Service Role Key

ุฅุฐุง ููุช ุชููู Service Role Key:

1. **ุนุฏูู ุงูููู**: `update_alaraf_contracts.mjs`
2. **ุงุณุชุจุฏู** `SUPABASE_ANON_KEY` ุจู `SUPABASE_SERVICE_ROLE_KEY`
3. **ููุฐ** ุงูุณูุฑูุจุช: `node update_alaraf_contracts.mjs`

โ๏ธ **ุชุญุฐูุฑ**: Service Role Key ูุชุฌุงูุฒ ุฌููุน ููุงุนุฏ ุงูุฃูุงูุ ุงุณุชุฎุฏูู ุจุญุฐุฑ!

---

## ๐ ุชูุถูุญ ุงููุดููุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุงูุณูุฑูุจุช ูุญุงูู ุงููุตูู ููุนููุฏ     โ
โ              โ                      โ
โ   RLS Policy ูููุน ุงููุตูู           โ
โ              โ                      โ
โ  ูุญุชุงุฌ authentication ุตุญูุญ         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุงุฎุชุฑ ุงูุญู ุงูููุงุณุจ** ูู ุงูุญููู ุฃุนูุงู
2. **ููุฐ ุงูุชุญุฏูุซ**
3. **ุชุญูู ูู ุงููุชุงุฆุฌ**
4. **ุฃุฎุจุฑูู ุจุงููุชูุฌุฉ**

---

**ุงูุญุงูุฉ ุงูุญุงููุฉ**: โณ ูู ุงูุชุธุงุฑ ุงูุชูููุฐ  
**ุงูุชูุตูุฉ**: ุงุณุชุฎุฏู Supabase Dashboard (ุงูุญู 1)
