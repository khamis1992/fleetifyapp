# ğŸ”§ Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ù†Ø´Ø± Edge Function

## âŒ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
```
C:\Users\khamis\Desktop\fleetifyapp-3>npx supabase functions deploy send-whatsapp-reminders
The system cannot find the path specified.
```

## ğŸ” Ø§Ù„ØªØ­Ù„ÙŠÙ„

### âœ… Ø§Ù„Ù…ØªÙˆÙØ±
- âœ… Supabase CLI Ù…Ø«Ø¨Øª (`supabase: ^2.39.2` ÙÙŠ devDependencies)
- âœ… Ø§Ù„Ù…Ø¬Ù„Ø¯ `supabase/functions/send-whatsapp-reminders/` Ù…ÙˆØ¬ÙˆØ¯
- âœ… Ø§Ù„Ù…Ù„Ù `index.ts` Ù…ÙˆØ¬ÙˆØ¯ ÙˆÙ…Ø­Ø¯Ù‘Ø«

### âš ï¸ Ø§Ù„Ù…ÙÙ‚ÙˆØ¯
- âŒ Ù…Ù„Ù `supabase.toml` ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
- âŒ Ù„Ù… ÙŠØªÙ… Ø±Ø¨Ø· Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù€ Supabase CLI

---

## ğŸš€ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø©

### Ø§Ù„Ø®ÙŠØ§Ø± 1: Ø§Ù„Ù†Ø´Ø± Ø¹Ø¨Ø± Supabase Dashboard (Ø§Ù„Ø£Ø³Ù‡Ù„ ÙˆØ§Ù„Ø£Ø³Ø±Ø¹) â­

#### Ø§Ù„Ø®Ø·ÙˆØ§Øª:

1. **Ø§ÙØªØ­ Supabase Dashboard**
   - Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰: https://supabase.com/dashboard
   - Ø§Ø®ØªØ± Ù…Ø´Ø±ÙˆØ¹Ùƒ

2. **Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Edge Functions**
   - Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©: **Edge Functions**

3. **Ø£Ù†Ø´Ø¦ Ø£Ùˆ Ø­Ø¯Ù‘Ø« Function**
   - Ø§Ø¶ØºØ· **Create a new function** Ø£Ùˆ Ø§Ø®ØªØ± `send-whatsapp-reminders` Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
   - Ø§Ø³Ù… Ø§Ù„Ù€ Function: `send-whatsapp-reminders`

4. **Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯**
   - Ø§ÙØªØ­ Ø§Ù„Ù…Ù„Ù: `supabase/functions/send-whatsapp-reminders/index.ts`
   - Ø§Ù†Ø³Ø® Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
   - Ø§Ù„ØµÙ‚ ÙÙŠ Ù…Ø­Ø±Ø± Dashboard

5. **Ø§Ø­ÙØ¸ ÙˆÙ†Ø´Ø±**
   - Ø§Ø¶ØºØ· **Deploy**

6. **Ø£Ø¶Ù Environment Variables**
   - ÙÙŠ Ù†ÙØ³ ØµÙØ­Ø© Edge Functions
   - Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ **Secrets**
   - Ø£Ø¶Ù:
     ```
     ULTRAMSG_INSTANCE_ID=your_instance_id
     ULTRAMSG_TOKEN=your_token
     ```

---

### Ø§Ù„Ø®ÙŠØ§Ø± 2: Ø¥Ø¹Ø¯Ø§Ø¯ Supabase CLI ÙˆØ±Ø¨Ø· Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ†)

#### 1. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Supabase CLI
```bash
npx supabase login
```

#### 2. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù supabase.toml
Ø£Ù†Ø´Ø¦ Ù…Ù„Ù `supabase.toml` ÙÙŠ Ø¬Ø°Ø± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:

```toml
# Project settings
project_id = "YOUR_PROJECT_ID"

[api]
enabled = true
port = 54321
schemas = ["public", "graphql_public"]
extra_search_path = ["public", "extensions"]
max_rows = 1000

[db]
port = 54322
major_version = 15

[studio]
enabled = true
port = 54323

[inbucket]
enabled = true
port = 54324

[storage]
enabled = true
file_size_limit = "50MiB"

[auth]
enabled = true
site_url = "http://localhost:3000"
additional_redirect_urls = ["https://localhost:3000"]
jwt_expiry = 3600

[edge-runtime]
enabled = true
port = 54325
```

#### 3. Ø±Ø¨Ø· Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
```bash
npx supabase link --project-ref YOUR_PROJECT_REF
```

> **Ù…Ù„Ø§Ø­Ø¸Ø©:** Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ `YOUR_PROJECT_REF` Ù…Ù†:
> Supabase Dashboard â†’ Project Settings â†’ General â†’ Reference ID

#### 4. Ù†Ø´Ø± Edge Function
```bash
npx supabase functions deploy send-whatsapp-reminders
```

---

### Ø§Ù„Ø®ÙŠØ§Ø± 3: Ø§Ø³ØªØ®Ø¯Ø§Ù… Supabase API Ù…Ø¨Ø§Ø´Ø±Ø©Ù‹ (Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ† Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ†)

Ø§Ø³ØªØ®Ø¯Ù… Management API Ù„Ù†Ø´Ø± Ø§Ù„Ù€ Function Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹.

---

## ğŸ¯ Ø§Ù„ØªÙˆØµÙŠØ©

### â­ Ù„Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹: Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø®ÙŠØ§Ø± 1 (Dashboard)

**Ø§Ù„Ù…Ø²Ø§ÙŠØ§:**
- âœ… Ø³Ø±ÙŠØ¹ ÙˆØ³Ù‡Ù„
- âœ… Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø¹Ù‚Ø¯Ø©
- âœ… ÙŠØ¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©
- âœ… ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¤ÙŠØ© Ø§Ù„ÙƒÙˆØ¯ ÙˆØ§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„ÙŠÙ‡ Ø¨Ø³Ù‡ÙˆÙ„Ø©

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**
1. Ø§ÙØªØ­ Supabase Dashboard
2. Edge Functions â†’ Create/Update
3. Ø§Ù†Ø³Ø® ÙƒÙˆØ¯ `index.ts` ÙˆØ§Ù„ØµÙ‚Ù‡
4. Ø§Ø¶ØºØ· Deploy
5. Ø£Ø¶Ù Secrets (ULTRAMSG_INSTANCE_ID, ULTRAMSG_TOKEN)

---

## ğŸ“‹ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¬Ø§Ù‡Ø² Ù„Ù„Ù†Ø³Ø®

### Ù…Ù„Ù index.ts
Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ: `supabase/functions/send-whatsapp-reminders/index.ts`

### Environment Secrets
```
ULTRAMSG_INSTANCE_ID=your_instance_id_here
ULTRAMSG_TOKEN=your_token_here
```

Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ… Ù…Ù†:
- https://ultramsg.com/dashboard
- Ø¨Ø¹Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Instance ÙˆØ±Ø¨Ø· WhatsApp

---

## âœ… Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø´Ø±

### Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù€ Function:

1. **Ù…Ù† Dashboard:**
   - Edge Functions â†’ `send-whatsapp-reminders` â†’ Invoke
   - Test Payload:
   ```json
   {
     "test": true,
     "phone": "97412345678",
     "message": "Ø±Ø³Ø§Ù„Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ© âœ…"
   }
   ```

2. **Ù…Ù† Terminal:**
   ```bash
   curl -X POST "https://qwhunliohlkkahbspfiu.supabase.co/functions/v1/send-whatsapp-reminders" \
     -H "Authorization: Bearer YOUR_ANON_KEY" \
     -H "Content-Type: application/json" \
     -d '{"test":true,"phone":"97412345678","message":"Ø±Ø³Ø§Ù„Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ© âœ…"}'
   ```

---

## ğŸ‰ Ø§Ù„Ù†ØªÙŠØ¬Ø©

Ø¨Ø¹Ø¯ Ø¥ÙƒÙ…Ø§Ù„ Ø£ÙŠ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ØŒ Ø³ÙŠÙƒÙˆÙ† Ù„Ø¯ÙŠÙƒ:
- âœ… Edge Function Ù…Ù†Ø´ÙˆØ±Ø© ÙˆÙ…Ø­Ø¯Ù‘Ø«Ø©
- âœ… Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Ultramsg API
- âœ… Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
- âœ… ÙŠÙ…ÙƒÙ† Ø§Ø®ØªØ¨Ø§Ø±Ù‡Ø§ ÙˆØªØ´ØºÙŠÙ„Ù‡Ø§

---

**Ø§Ù„Ø­Ø§Ù„Ø©:** Ø¬Ø§Ù‡Ø² Ù„Ù„Ù†Ø´Ø± âœ…  
**Ø§Ù„ØªÙˆØµÙŠØ©:** Ø§Ø³ØªØ®Ø¯Ù… Dashboard (Ø§Ù„Ø®ÙŠØ§Ø± 1) Ù„Ù„Ø³Ø±Ø¹Ø©

