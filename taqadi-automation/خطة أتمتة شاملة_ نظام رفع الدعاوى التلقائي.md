# خطة أتمتة شاملة: نظام رفع الدعاوى التلقائي
## من موقع alaraf.online إلى موقع تقاضي

---

## المرحلة 1: نظرة عامة على النظام

### الهدف الرئيسي
بناء نظام متكامل يقوم برفع الدعاوى تلقائياً من موقع alaraf.online إلى موقع تقاضي دون تدخل يدوي.

### المدخلات (Inputs)
- **موقع alaraf.online**: قائمة العقود المتعثرة مع بيانات العملاء والمبالغ
- **موقع تقاضي**: نموذج رفع الدعوى بـ 6 خطوات

### المخرجات (Outputs)
- دعاوى مرفوعة في موقع تقاضي
- أرقام الدعاوى المسندة
- حالة محدثة في موقع alaraf.online

---

## المرحلة 2: معمارية النظام

### 2.1 مكونات النظام الرئيسية

```
┌─────────────────────────────────────────────────────────┐
│                   نظام الأتمتة الرئيسي                    │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌──────────────┐    ┌──────────────┐   ┌────────────┐ │
│  │  استخراج     │    │   معالجة     │   │   ملء      │ │
│  │  البيانات    │───▶│   البيانات    │──▶│  النموذج   │ │
│  │              │    │              │   │            │ │
│  └──────────────┘    └──────────────┘   └────────────┘ │
│         ▲                                       │       │
│         │                                       ▼       │
│  ┌──────────────────────────────────────────────────┐  │
│  │         قاعدة البيانات المركزية                   │  │
│  │  (تخزين الحالات، البيانات، أرقام الدعاوى)        │  │
│  └──────────────────────────────────────────────────┘  │
│         ▲                                       │       │
│         │                                       ▼       │
│  ┌──────────────┐    ┌──────────────┐   ┌────────────┐ │
│  │  تحديث       │    │   تحميل      │   │   تقديم    │ │
│  │  alaraf      │◀───│  المستندات   │◀──│  الدعوى    │ │
│  │              │    │              │   │            │ │
│  └──────────────┘    └──────────────┘   └────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 2.2 المكونات التفصيلية

#### أ) وحدة استخراج البيانات (Data Extraction Module)
**المصدر**: موقع alaraf.online
**المخرجات**: بيانات منظمة للعقود المتعثرة

```json
{
  "contract_id": "C-ALF-0025",
  "defendant_name": "ياسين سرحان كمال بن عايد",
  "defendant_id": "29850400215",
  "defendant_phone": "71002048",
  "vehicle_model": "Bestune T77 2023",
  "vehicle_plate": "2780",
  "overdue_rent": 23100,
  "late_fee": 1155,
  "admin_fees": 500,
  "total_amount": 24755,
  "amount_in_words": "أربعة وعشرون ألف وسبعمائة وخمسة وخمسون ريال قطري",
  "overdue_days": 332,
  "case_status": "pending"
}
```

#### ب) وحدة معالجة البيانات (Data Processing Module)
**الوظيفة**: تحضير البيانات للملء التلقائي

**المعالجات**:
1. التحقق من اكتمال البيانات
2. تحويل الصيغ (تحويل التواريخ، الأرقام)
3. إضافة البيانات الناقصة من قاعدة البيانات
4. توليد النصوص (الوقائع، الطلبات، عنوان الدعوى)

#### ج) وحدة ملء النموذج (Form Filling Module)
**المصدر**: موقع تقاضي
**الوظيفة**: ملء نموذج الدعوى تلقائياً

**الخطوات**:
1. تسجيل الدخول إلى موقع تقاضي
2. الانتقال إلى صفحة إنشاء دعوى
3. ملء الخطوة 1: نوع الدعوى
4. ملء الخطوة 2: تفاصيل الدعوى
5. ملء الخطوة 3: أطراف الدعوى
6. ملء الخطوة 4: المستندات
7. ملء الخطوة 5: تفاصيل الرسوم
8. ملء الخطوة 6: ملخص الدعوى
9. تقديم الدعوى

#### د) وحدة تحميل المستندات (Document Upload Module)
**المستندات المطلوبة**:
1. مذكرة شارحة (WORD + PDF)
2. صورة البطاقة الشخصية
3. صورة السجل التجاري
4. صورة قيد المنشأة
5. صورة العقد
6. شهادة IBAN
7. كشف المطالبات

#### هـ) وحدة التحديث (Update Module)
**الوظيفة**: تحديث حالة الدعاوى في موقع alaraf.online

**البيانات المحدثة**:
- رقم الدعوى المسند
- حالة الدعوى (مرفوعة)
- تاريخ الرفع
- رابط الدعوى في تقاضي

---

## المرحلة 3: خطوات الملء التفصيلية

### الخطوة 1: نوع الدعوى (0%)

| الحقل | القيمة | الملاحظات |
|------|--------|----------|
| **درجة التقاضي** | ابتدائي | ثابت |
| **النوع** | عقود الخدمات التجارية | ثابت |
| **النوع الفرعي** | عقود ايجار السيارات وخدمات الليموزين | ثابت |
| **الموضوع الفرعي** | لا ينطبق | ثابت |

**كود الملء**:
```javascript
// اختيار درجة التقاضي
selectDropdown('court_level', 'ابتدائي');

// اختيار النوع
selectDropdown('case_type', 'عقود الخدمات التجارية');

// اختيار النوع الفرعي
selectDropdown('case_subtype', 'عقود ايجار السيارات وخدمات الليموزين');

// اختيار الموضوع الفرعي
selectDropdown('subject', 'لا ينطبق');

// الضغط على التالي
clickButton('next');
```

### الخطوة 2: تفاصيل الدعوى (20%)

| الحقل | المصدر | الملاحظات |
|------|--------|----------|
| **عنوان الدعوى** | alaraf.online | محسوب تلقائياً |
| **تفاصيل المطالبة** | alaraf.online | محسوب تلقائياً |
| **الوقائع** | alaraf.online | محسوب تلقائياً |
| **الطلبات** | alaraf.online | محسوب تلقائياً |
| **نوع المطالبة** | ثابت | تحصيل دين |
| **المبلغ** | alaraf.online | من ملخص المطالبة |
| **المبلغ الإجمالي كتابة** | alaraf.online | محسوب تلقائياً |

**كود الملء**:
```javascript
// ملء عنوان الدعوى
fillTextField('case_title', data.case_title);

// ملء تفاصيل المطالبة
fillTextArea('claim_details', data.claim_details);

// ملء الوقائع
fillTextArea('facts', data.facts);

// ملء الطلبات
fillTextArea('requests', data.requests);

// اختيار نوع المطالبة
selectDropdown('claim_type', 'تحصيل دين');

// ملء المبلغ
fillTextField('amount', data.total_amount);

// ملء المبلغ كتابة
fillTextField('amount_in_words', data.amount_in_words);

// الضغط على التالي
clickButton('next');
```

### الخطوة 3: أطراف الدعوى (40%)

#### المدعي (الشركة - مملوء بالفعل)
- الاسم: من بيانات المستخدم المسجل

#### المدعى عليه (العميل المتعثر)

| الحقل | المصدر | الملاحظات |
|------|--------|----------|
| **تصنيف الطرف** | ثابت | شخص طبيعي |
| **صفة الطرف** | ثابت | مدعى عليه |
| **الترتيب** | ثابت | 1 |
| **الاسم الأول** | alaraf.online | من بيانات العميل |
| **الاسم الثاني** | alaraf.online | اختياري |
| **اسم العائلة** | alaraf.online | من بيانات العميل |
| **تاريخ الميلاد** | قاعدة البيانات | مطلوب |
| **الجنسية** | قاعدة البيانات | مطلوب |
| **نوع البطاقة** | قاعدة البيانات | مطلوب |
| **تاريخ الإصدار** | قاعدة البيانات | مطلوب |
| **تاريخ الانتهاء** | قاعدة البيانات | مطلوب |
| **العنوان** | قاعدة البيانات | مطلوب |
| **رقم الهاتف المحمول** | alaraf.online | من بيانات العميل |
| **البريد الإلكتروني** | قاعدة البيانات | مطلوب |

**كود الملء**:
```javascript
// إضافة طرف جديد (المدعى عليه)
clickButton('add_party');

// اختيار تصنيف الطرف
selectDropdown('party_classification', 'شخص طبيعي');

// اختيار صفة الطرف
selectDropdown('party_role', 'مدعى عليه');

// ملء الترتيب
fillTextField('party_order', '1');

// ملء بيانات الطرف
fillTextField('first_name', data.defendant_first_name);
fillTextField('middle_name', data.defendant_middle_name);
fillTextField('last_name', data.defendant_last_name);
fillDateField('date_of_birth', data.date_of_birth);

// اختيار الجنسية
selectDropdown('nationality', data.nationality);

// اختيار نوع البطاقة
selectDropdown('id_type', data.id_type);

// ملء تواريخ البطاقة
fillDateField('id_issue_date', data.id_issue_date);
fillDateField('id_expiry_date', data.id_expiry_date);

// ملء معلومات التواصل
fillTextArea('address', data.address);
fillTextField('mobile_phone', data.mobile_phone);
fillTextField('email', data.email);

// الضغط على حفظ
clickButton('save_party');

// الضغط على التالي
clickButton('next');
```

### الخطوة 4: المستندات (60%)

**المستندات المطلوبة**:

| المستند | النوع | المصدر | الملاحظات |
|--------|------|--------|----------|
| **مذكرة شارحة** | PDF + WORD | توليد AI | يجب رفع صيغتين متطابقتين |
| **صورة البطاقة** | صورة | قاعدة البيانات | - |
| **السجل التجاري** | صورة | قاعدة البيانات | - |
| **قيد المنشأة** | صورة | قاعدة البيانات | - |
| **العقد** | صورة/PDF | alaraf.online | من نظام العقود |
| **شهادة IBAN** | صورة/PDF | قاعدة البيانات | - |
| **كشف المطالبات** | PDF | توليد من الفواتير | - |

**كود الملء**:
```javascript
// إضافة مذكرة شارحة (PDF)
clickButton('add_document');
selectDocumentType('مذكرة شارحة');
uploadFile('memo_document.pdf');

// إضافة مذكرة شارحة (WORD)
clickButton('add_document');
selectDocumentType('مذكرة شارحة');
uploadFile('memo_document.docx');

// إضافة صورة البطاقة
clickButton('add_document');
selectDocumentType('صورة البطاقة الشخصية');
uploadFile('id_card.jpg');

// إضافة السجل التجاري
clickButton('add_document');
selectDocumentType('السجل التجاري');
uploadFile('commercial_register.pdf');

// إضافة قيد المنشأة
clickButton('add_document');
selectDocumentType('قيد المنشأة');
uploadFile('establishment_registration.pdf');

// إضافة العقد
clickButton('add_document');
selectDocumentType('العقد');
uploadFile('contract.pdf');

// إضافة شهادة IBAN
clickButton('add_document');
selectDocumentType('شهادة IBAN');
uploadFile('iban_certificate.pdf');

// إضافة كشف المطالبات
clickButton('add_document');
selectDocumentType('كشف المطالبات');
uploadFile('claims_statement.pdf');

// الضغط على التالي
clickButton('next');
```

### الخطوة 5: تفاصيل الرسوم (80%)

**الملاحظة**: هذه الخطوة تحسب الرسوم تلقائياً بناءً على المبلغ

```javascript
// هذه الخطوة تلقائية - لا تحتاج تدخل
// فقط الضغط على التالي
clickButton('next');
```

### الخطوة 6: ملخص الدعوى (100%)

**الإجراء**: مراجعة البيانات وتقديم الدعوى

```javascript
// توسيع جميع الأقسام للتحقق
clickButton('expand_all');

// التحقق من البيانات (اختياري - للتسجيل)
verifyData();

// الضغط على اعتماد (تقديم الدعوى)
clickButton('approve');

// انتظار رقم الدعوى
waitForCaseNumber();

// حفظ رقم الدعوى
saveCaseNumber(case_number);
```

---

## المرحلة 4: البيانات الناقصة والحلول

### البيانات الناقصة من alaraf.online:

| البيان | الحل المقترح | الأولوية |
|------|------------|---------|
| **تاريخ الميلاد** | إدخال يدوي أو قاعدة بيانات | عالية |
| **الجنسية** | قاعدة بيانات أو افتراض (قطري) | عالية |
| **نوع البطاقة** | قاعدة بيانات أو افتراض (بطاقة هوية) | عالية |
| **تواريخ البطاقة** | قاعدة بيانات أو إدخال يدوي | عالية |
| **العنوان** | قاعدة بيانات أو من بيانات العقد | متوسطة |
| **البريد الإلكتروني** | قاعدة بيانات أو توليد من الاسم | متوسطة |

### الحلول:

#### 1. توسيع قاعدة البيانات
إضافة حقول جديدة في جدول العملاء:
- تاريخ الميلاد
- الجنسية
- نوع البطاقة
- تاريخ إصدار البطاقة
- تاريخ انتهاء البطاقة
- العنوان
- البريد الإلكتروني

#### 2. واجهة إدخال البيانات الناقصة
إنشاء نموذج في موقع alaraf.online لإدخال البيانات الناقصة قبل رفع الدعوى

#### 3. القيم الافتراضية
- الجنسية: قطري (افتراضي)
- نوع البطاقة: بطاقة هوية (افتراضي)
- العنوان: من بيانات العقد (افتراضي)

---

## المرحلة 5: تدفق العملية الكاملة

```
┌──────────────────────────────────────────────────────────┐
│  1. المستخدم يضغط "رفع دعوى" من قائمة العقود المتعثرة    │
└──────────────────────────────────────────────────────────┘
                            ▼
┌──────────────────────────────────────────────────────────┐
│  2. فتح صفحة تجهيز الدعوى مع البيانات المحسوبة تلقائياً    │
└──────────────────────────────────────────────────────────┘
                            ▼
┌──────────────────────────────────────────────────────────┐
│  3. التحقق من اكتمال البيانات الناقصة                     │
│     - إذا ناقصة: طلب إدخال البيانات                     │
│     - إذا كاملة: المتابعة                               │
└──────────────────────────────────────────────────────────┘
                            ▼
┌──────────────────────────────────────────────────────────┐
│  4. المستخدم يختار:                                      │
│     أ) نسخ يدوي وملء يدوي في تقاضي                     │
│     ب) ملء تلقائي كامل (Automation)                    │
└──────────────────────────────────────────────────────────┘
                            ▼
┌──────────────────────────────────────────────────────────┐
│  5. إذا اختار الملء التلقائي:                            │
│     - تسجيل الدخول إلى تقاضي                           │
│     - ملء النموذج تلقائياً (6 خطوات)                   │
│     - تحميل المستندات                                  │
│     - تقديم الدعوى                                     │
└──────────────────────────────────────────────────────────┘
                            ▼
┌──────────────────────────────────────────────────────────┐
│  6. حفظ رقم الدعوى وتحديث الحالة في alaraf.online      │
└──────────────────────────────────────────────────────────┘
                            ▼
┌──────────────────────────────────────────────────────────┐
│  7. إرسال إشعار للمستخدم برقم الدعوى                     │
└──────────────────────────────────────────────────────────┘
```

---

## المرحلة 6: التحديات والحلول

### التحدي 1: عدم توفر API في موقع تقاضي
**الحل**: استخدام Selenium/Puppeteer للتفاعل مع الموقع

### التحدي 2: المصادقة في موقع تقاضي
**الحل**: 
- حفظ بيانات المستخدم بشكل آمن
- استخدام Session Management
- تحديث التوكنات تلقائياً

### التحدي 3: البيانات الناقصة
**الحل**:
- توسيع قاعدة البيانات
- إنشاء نموذج إدخال بيانات
- استخدام قيم افتراضية

### التحدي 4: تحميل المستندات
**الحل**:
- توليد المستندات تلقائياً (مذكرة شارحة، كشف المطالبات)
- تخزين المستندات في قاعدة البيانات
- رفع المستندات تلقائياً

### التحدي 5: معالجة الأخطاء والاستثناءات
**الحل**:
- نظام تسجيل شامل (Logging)
- إعادة محاولة تلقائية
- إشعارات للمستخدم عند الفشل

---

## المرحلة 7: خطة التطوير والتنفيذ

### المرحلة 1: الإعداد (أسبوع 1)
- [ ] إعداد بيئة التطوير
- [ ] تثبيت المكتبات المطلوبة (Selenium, Puppeteer)
- [ ] إعداد قاعدة البيانات

### المرحلة 2: تطوير وحدة استخراج البيانات (أسبوع 2)
- [ ] إنشاء Web Scraper لموقع alaraf.online
- [ ] اختبار استخراج البيانات
- [ ] توثيق البيانات المستخرجة

### المرحلة 3: تطوير وحدة معالجة البيانات (أسبوع 3)
- [ ] إنشاء معالجات البيانات
- [ ] توليد النصوص (الوقائع، الطلبات)
- [ ] التحقق من اكتمال البيانات

### المرحلة 4: تطوير وحدة ملء النموذج (أسبوع 4-5)
- [ ] إنشاء Bot للتفاعل مع موقع تقاضي
- [ ] ملء الخطوات الـ 6
- [ ] اختبار شامل

### المرحلة 5: تطوير وحدة تحميل المستندات (أسبوع 6)
- [ ] توليد المستندات
- [ ] تحميل المستندات تلقائياً
- [ ] التحقق من التحميل

### المرحلة 6: تطوير وحدة التحديث (أسبوع 7)
- [ ] تحديث حالة الدعاوى في alaraf.online
- [ ] حفظ أرقام الدعاوى
- [ ] إنشاء تقارير

### المرحلة 7: الاختبار والتطوير (أسبوع 8)
- [ ] اختبار شامل للنظام
- [ ] معالجة الأخطاء
- [ ] توثيق النظام

### المرحلة 8: النشر والمراقبة (أسبوع 9)
- [ ] نشر النظام
- [ ] مراقبة الأداء
- [ ] دعم المستخدمين

---

## المرحلة 8: المتطلبات التقنية

### المكتبات والأدوات:
- **Selenium** أو **Puppeteer**: للتفاعل مع المواقع
- **Python** أو **Node.js**: لغة البرمجة
- **Database**: MySQL أو PostgreSQL
- **API Framework**: Flask أو Express.js
- **Document Generation**: ReportLab أو PDFKit
- **Logging**: Winston أو Python Logging

### البنية التحتية:
- **Server**: لتشغيل النظام
- **Database Server**: لتخزين البيانات
- **File Storage**: لتخزين المستندات
- **Scheduler**: لتشغيل المهام الدورية

---

## المرحلة 9: الأمان والخصوصية

### إجراءات الأمان:
- تشفير بيانات المستخدم
- استخدام HTTPS
- التحقق من الهوية (2FA)
- تسجيل جميع العمليات
- حذف البيانات الحساسة بعد الاستخدام

### الامتثال القانوني:
- الامتثال لقوانين حماية البيانات
- الامتثال لشروط خدمة موقع تقاضي
- توثيق جميع العمليات

---

## الخلاصة

هذه الخطة توفر رؤية شاملة لبناء نظام أتمتة متكامل لرفع الدعاوى تلقائياً. يمكن تطبيقها بشكل تدريجي، مع البدء بالمرحلة الأولى والانتقال تدريجياً إلى المراحل الأخرى.

**النقاط الرئيسية**:
✓ استخراج البيانات تلقائياً من alaraf.online
✓ ملء نموذج تقاضي تلقائياً (6 خطوات)
✓ تحميل المستندات المطلوبة
✓ تقديم الدعوى تلقائياً
✓ تحديث حالة الدعاوى في alaraf.online
✓ نظام شامل للمراقبة والتقارير
