# ุฏููู ุชุดุบูู ุฎุฏูุฉ ุฑูุน ูุณุชูุฏุงุช ุงูุนููุงุก ุงูุณุฑูุน
## Quick Setup Guide for Customer Documents Upload

---

## โ ุงูุฎุทูุงุช ุงููุทููุจุฉ (Required Steps)

### ุงูุฎุทูุฉ 1๏ธโฃ: ุชุดุบูู SQL Migration

1. ุงูุชุญ **Supabase Dashboard**
2. ุงุฐูุจ ุฅูู **SQL Editor** (ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ)
3. ุงุถุบุท **New Query**
4. ุงูุณุฎ **ูุงูู** ูุญุชูู ุงูููู: `CUSTOMER_DOCUMENTS_MIGRATION_MANUAL.sql`
5. ุงูุตู ุงููุญุชูู ูู SQL Editor
6. ุงุถุบุท **Run** ุฃู **Ctrl+Enter**

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```
Success. No rows returned.
```

---

### ุงูุฎุทูุฉ 2๏ธโฃ: ุฅูุดุงุก Storage Bucket

1. ูู Supabase Dashboardุ ุงุฐูุจ ุฅูู **Storage**
2. ุงุถุบุท **Create a new bucket**
3. ุงููุฃ ุงูุจูุงูุงุช:
   - **Name:** `customer-documents`
   - **Public:** โ (ูุง ุชูุนููุ ุงุชุฑููุง ุฎุงุตุฉ)
   - **File size limit:** ููููู ุชุฑููุง 50MB ุฃู ุชุบููุฑูุง ุญุณุจ ุงูุญุงุฌุฉ
4. ุงุถุบุท **Create bucket**

---

### ุงูุฎุทูุฉ 3๏ธโฃ: ุฅุถุงูุฉ Storage Policies

1. ูู ุตูุญุฉ Storageุ ุงุฎุชุฑ bucket **customer-documents**
2. ุงุฐูุจ ุฅูู ุชุจููุจ **Policies**
3. ุงุถุบุท **New Policy**

ุฃุถู ูุฐู ุงูุณูุงุณุงุช ุงูุฃุฑุจุนุฉ:

#### Policy 1: ุฑูุน ุงููููุงุช (INSERT)
- **Policy name:** `Users can upload customer documents`
- **Allowed operation:** INSERT โ
- **Policy definition:**
```sql
(bucket_id = 'customer-documents'::text) AND (auth.uid() IN ( SELECT profiles.user_id FROM profiles))
```
- ุงุถุบุท **Review** ุซู **Save policy**

#### Policy 2: ุนุฑุถ ุงููููุงุช (SELECT)
- **Policy name:** `Users can view customer documents`
- **Allowed operation:** SELECT โ
- **Policy definition:**
```sql
(bucket_id = 'customer-documents'::text) AND (auth.uid() IN ( SELECT profiles.user_id FROM profiles))
```
- ุงุถุบุท **Review** ุซู **Save policy**

#### Policy 3: ุชุญุฏูุซ ุงููููุงุช (UPDATE)
- **Policy name:** `Users can update customer documents`
- **Allowed operation:** UPDATE โ
- **Policy definition:**
```sql
(bucket_id = 'customer-documents'::text) AND (auth.uid() IN ( SELECT profiles.user_id FROM profiles))
```
- ุงุถุบุท **Review** ุซู **Save policy**

#### Policy 4: ุญุฐู ุงููููุงุช (DELETE)
- **Policy name:** `Users can delete customer documents`
- **Allowed operation:** DELETE โ
- **Policy definition:**
```sql
(bucket_id = 'customer-documents'::text) AND (auth.uid() IN ( SELECT profiles.user_id FROM profiles))
```
- ุงุถุบุท **Review** ุซู **Save policy**

---

### ุงูุฎุทูุฉ 4๏ธโฃ: ุงูุชุญูู ูู ุงูุชุซุจูุช

ูู ุจุชุดุบูู ูุฐุง ุงูุงุณุชุนูุงู ูู **SQL Editor**:

```sql
-- ุงูุชุญูู ูู ุงูุฌุฏูู
SELECT COUNT(*) as table_exists 
FROM information_schema.tables 
WHERE table_name = 'customer_documents';
-- ูุฌุจ ุฃู ูุฑุฌุน 1

-- ุงูุชุญูู ูู ุงูุฃุนูุฏุฉ
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'customer_documents'
ORDER BY ordinal_position;
-- ูุฌุจ ุฃู ูุฑุฌุน 14 ุตู (ุนุฏุฏ ุงูุฃุนูุฏุฉ)

-- ุงูุชุญูู ูู ุงูุณูุงุณุงุช
SELECT policyname 
FROM pg_policies 
WHERE tablename = 'customer_documents';
-- ูุฌุจ ุฃู ูุฑุฌุน 4 ุณูุงุณุงุช
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ (Testing)

1. ุงูุชุญ ุงูุชุทุจูู ูุณุฌูู ุงูุฏุฎูู
2. ุงุฐูุจ ุฅูู **ุตูุญุฉ ุงูุนููุงุก**
3. ุงูุชุญ **ุชูุงุตูู ุฃู ุนููู**
4. ุงุถุบุท ุนูู ุชุจููุจ **ุงููุณุชูุฏุงุช**
5. ุงุฎุชุฑ ููุน ุงููุณุชูุฏ ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ
6. ุงุถุบุท **ุงุฎุชุฑ ููู**
7. ุงุฎุชุฑ ููู ูู ุฌูุงุฒู
8. ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ: "ุชู ุฑูุน ุงููุณุชูุฏ ุจูุฌุงุญ" โ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก (Troubleshooting)

### ูุดููุฉ: "ูุดู ุฅูุดุงุก ุณุฌู ูุงุนุฏุฉ ุงูุจูุงูุงุช"
**ุงูุญู:**
- ุชุญูู ูู ุชุดุบูู SQL Migration ุจูุฌุงุญ
- ุชุญูู ูู RLS Policies ููุฌุฏูู
- ุชุฃูุฏ ูู ุชุณุฌูู ุงูุฏุฎูู

### ูุดููุฉ: "ูุดู ุฑูุน ุงูููู"
**ุงูุญู:**
- ุชุญูู ูู ุฅูุดุงุก Storage Bucket
- ุชุญูู ูู Storage Policies ุงูุฃุฑุจุนุฉ
- ุชุฃูุฏ ุฃู ุงูู Bucket ุงุณูู ุจุงูุถุจุท: `customer-documents`

### ูุดููุฉ: "ูุนุฑู ุงูุดุฑูุฉ ููููุฏ"
**ุงูุญู:**
- ุชุฃูุฏ ูู ูุฌูุฏ `company_id` ูู ุฌุฏูู `profiles` ูููุณุชุฎุฏู ุงูุญุงูู
- ุดุบูู ูุฐุง ุงูุงุณุชุนูุงู:
```sql
SELECT user_id, company_id 
FROM profiles 
WHERE user_id = auth.uid();
```

### ูุดููุฉ: ุงููุณุชูุฏุงุช ูุง ุชุธูุฑ ุจุนุฏ ุงูุฑูุน
**ุงูุญู:**
- ุงูุชุญ Developer Console (F12)
- ุงูุธุฑ ุฅูู ุชุจููุจ **Console** ููุฃุฎุทุงุก
- ุงูุธุฑ ุฅูู ุชุจููุจ **Network** ูุฑุคูุฉ ุงูุทูุจุงุช
- ุชุญูู ูู RLS Policies

---

## ๐ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ (Final Checklist)

ูุจู ุงูุงุณุชุฎุฏุงูุ ุชุฃูุฏ ูู:

- โ ุชุดุบูู SQL Migration ุจูุฌุงุญ
- โ ุฅูุดุงุก Storage Bucket: `customer-documents`
- โ ุฅุถุงูุฉ 4 Storage Policies
- โ ุงุฎุชุจุงุฑ ุฑูุน ููู ูุงุญุฏ ุนูู ุงูุฃูู
- โ ุงุฎุชุจุงุฑ ุชุญููู ุงููุณุชูุฏ
- โ ุงุฎุชุจุงุฑ ุญุฐู ุงููุณุชูุฏ

---

## ๐ก ูุตุงุฆุญ ูููุฉ (Important Tips)

1. **ุญุฌู ุงููููุงุช:** ุงูุญุฏ ุงูุฃูุตู 10MB (ูููู ุชุนุฏููู ูู ุงูููุฏ)
2. **ุงูุตูุบ ุงููุฏุนููุฉ:** PDF, JPG, JPEG, PNG, DOC, DOCX
3. **ุงูุฃูุงู:** ุฌููุน ุงููุณุชูุฏุงุช ุฎุงุตุฉ ููุญููุฉ ุจู RLS
4. **ุงูุฃุฏุงุก:** ุงููููุงุช ุชูุฎุฒู ูู CDN ุณุฑูุน
5. **ุงููุณุฎ ุงูุงุญุชูุงุทู:** Supabase ูููู ุจุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ (Next Steps)

ุจุนุฏ ุงูุชุซุจูุช ุงููุงุฌุญุ ููููู:

1. **ุฑูุน ูุณุชูุฏุงุช ููุนููุงุก ุงูุญุงูููู**
2. **ุชุญุฏูุฏ ุงููุณุชูุฏุงุช ุงููุทููุจุฉ** (ุนุจุฑ ุญูู `is_required`)
3. **ุฅุถุงูุฉ ููุงุญุธุงุช ูููุณุชูุฏุงุช** (ุนุจุฑ ุญูู `notes`)
4. **ุชุตููู ุงููุณุชูุฏุงุช ุญุณุจ ุงูููุน**

---

## ๐ ุงูุฏุนู (Support)

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:

1. ุฑุงุฌุน ููู `CUSTOMER_DOCUMENTS_FIX.md` ููุชูุงุตูู ุงููุงููุฉ
2. ุชุญูู ูู Supabase Logs ูู Dashboard
3. ุงูุชุญ Developer Console ููุฃุฎุทุงุก
4. ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช

---

**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุจุนุฏ ุชุทุจูู ุงูุฎุทูุงุช ุฃุนูุงู  
**ุงูููุช ุงููุชููุน ููุชุซุจูุช:** 5-10 ุฏูุงุฆู  
**ุตุนูุจุฉ ุงูุชุซุจูุช:** โญโญ (ุณูู)

---

## ๐ ุชูุงูููุง!

ุจุนุฏ ุฅููุงู ุฌููุน ุงูุฎุทูุงุชุ ุณุชููู ุฎุฏูุฉ ุฑูุน ุงููุณุชูุฏุงุช ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู! ๐

