# โ ุตูุญุฉ ุชูุงุตูู ุงูุนููู - ุชุญุฏูุซ ููุจูุงูุงุช ุงูุญููููุฉ

## ๐ ุชู ุงูุชุญุฏูุซ ุจูุฌุงุญ!

ุชู ุชุญุฏูุซ **ุตูุญุฉ ุชูุงุตูู ุงูุนููู** ูุชุณุชุฎุฏู **ุจูุงูุงุช ุญููููุฉ 100%** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช!

---

## ๐ ูุง ุชู ุชุบููุฑู

### ูุจู โ (ุจูุงูุงุช ููููุฉ)
```typescript
// ูุงูุช ุชุณุชุฎุฏู useMemo ูุน ุจูุงูุงุช ุซุงุจุชุฉ
const customerData = useMemo(() => ({
  name: 'ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ',  // ุซุงุจุช
  email: 'ahmed@email.com',     // ุซุงุจุช
  ...
}), []);

const contracts = useMemo(() => [
  { vehicleName: 'ุชูููุชุง ูุงูุฑู' },  // ุซุงุจุช
  ...
], []);
```

### ุจุนุฏ โ (ุจูุงูุงุช ุญููููุฉ)
```typescript
// ุงูุขู ุชุณุชุฎุฏู useQuery ูุฌูุจ ุจูุงูุงุช ุญููููุฉ
const { data: customer } = useQuery({
  queryKey: ['customer-details', customerId],
  queryFn: async () => {
    const { data } = await supabase
      .from('customers')
      .select('*')
      .eq('id', customerId)
      .single();
    return data;
  }
});

const { data: contracts } = useQuery({
  queryKey: ['customer-contracts', customerId],
  queryFn: async () => {
    const { data } = await supabase
      .from('contracts')
      .select(`*, vehicle:vehicles(*)`)
      .eq('customer_id', customerId);
    return data;
  }
});
```

---

## โ ุงูุจูุงูุงุช ุงููุฌููุจุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 1. ุจูุงูุงุช ุงูุนููู (customers table):
```sql
SELECT *
FROM customers
WHERE id = ? AND company_id = ?
```

**ุงูุญููู ุงููุณุชุฎุฏูุฉ:**
- โ `customer_code` - ุฑูู ุงูุนููู
- โ `first_name_ar` + `last_name_ar` - ุงูุงุณู
- โ `company_name_ar` - ุงุณู ุงูุดุฑูุฉ (ููุดุฑูุงุช)
- โ `customer_type` - ููุน ุงูุนููู (ูุฑุฏ/ุดุฑูุฉ)
- โ `email` - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- โ `phone` - ุฑูู ุงูุฌูุงู
- โ `address` - ุงูุนููุงู
- โ `date_of_birth` - ุชุงุฑูุฎ ุงููููุงุฏ
- โ `national_id` - ุฑูู ุงููููุฉ
- โ `is_active` - ุงูุญุงูุฉ
- โ `is_vip` - ุนููู ูููุฒ
- โ `created_at` - ุชุงุฑูุฎ ุงูุชุณุฌูู
- โ `updated_at` - ุขุฎุฑ ุชุญุฏูุซ

### 2. ุนููุฏ ุงูุนููู (contracts table):
```sql
SELECT 
  contracts.*,
  vehicles.make,
  vehicles.model,
  vehicles.year,
  vehicles.plate_number
FROM contracts
LEFT JOIN vehicles ON contracts.vehicle_id = vehicles.id
WHERE customer_id = ?
ORDER BY created_at DESC
```

**ุงูุญููู ุงููุณุชุฎุฏูุฉ:**
- โ `contract_number` - ุฑูู ุงูุนูุฏ
- โ `start_date` - ุชุงุฑูุฎ ุงูุจุฏุงูุฉ
- โ `end_date` - ุชุงุฑูุฎ ุงูุงูุชูุงุก
- โ `monthly_amount` - ุงููุจูุบ ุงูุดูุฑู
- โ `contract_amount` - ุฅุฌูุงูู ุงูุนูุฏ
- โ `total_paid` - ุงููุฏููุน
- โ `status` - ุงูุญุงูุฉ
- โ `vehicle` (ุนูุงูุฉ) - ูุนูููุงุช ุงูุณูุงุฑุฉ

### 3. ูุฏููุนุงุช ุงูุนููู (payments table):
```sql
SELECT *
FROM payments
WHERE customer_id = ?
ORDER BY payment_date DESC
LIMIT 10
```

**ุงูุญููู ุงููุณุชุฎุฏูุฉ:**
- โ `payment_number` - ุฑูู ุงูุฏูุนุฉ
- โ `payment_date` - ุชุงุฑูุฎ ุงูุฏูุน
- โ `amount` - ุงููุจูุบ
- โ `payment_method` - ุทุฑููุฉ ุงูุฏูุน
- โ `payment_status` - ุงูุญุงูุฉ
- โ `contract_id` - ุฑูู ุงูุนูุฏ

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุญุณูุจุฉ

### ูู ูุฐู ุงูุฅุญุตุงุฆูุงุช ุชูุญุณุจ ูู ุงูุจูุงูุงุช ุงูุญููููุฉ:

#### 1. ุนุฏุฏ ุงูุนููุฏ ุงููุดุทุฉ
```typescript
const activeContracts = contracts.filter(c => c.status === 'active').length;
```

#### 2. ุงููุจูุบ ุงููุณุชุญู
```typescript
const totalContractAmount = contracts
  .filter(c => c.status === 'active')
  .reduce((sum, c) => sum + c.contract_amount, 0);
  
const totalPaid = contracts
  .filter(c => c.status === 'active')
  .reduce((sum, c) => sum + c.total_paid, 0);
  
const outstandingAmount = totalContractAmount - totalPaid;
```

#### 3. ูุณุจุฉ ุงูุงูุชุฒุงู
```typescript
const paidOnTime = payments.filter(p => p.payment_status === 'completed').length;
const commitmentRate = Math.round((paidOnTime / payments.length) * 100);
```

#### 4. ุฅุฌูุงูู ุงููุฏููุนุงุช
```typescript
const totalPayments = payments.reduce((sum, p) => sum + p.amount, 0);
```

---

## ๐ ุงูุชูุณูู ุงูุชููุงุฆู

### 1. ุงุณู ุงูุนููู
```typescript
// ููุฃูุฑุงุฏ
name = `${first_name_ar} ${last_name_ar}`;

// ููุดุฑูุงุช
name = company_name_ar || company_name;
```

### 2. ุงุณู ุงูุณูุงุฑุฉ
```typescript
vehicleName = `${vehicle.make} ${vehicle.model} ${vehicle.year}`;
// ูุซุงู: "ุชูููุชุง ูุงูุฑู 2024"
```

### 3. ุงูุฃูุงู ุงููุชุจููุฉ
```typescript
daysRemaining = differenceInDays(end_date, new Date());
```

### 4. ุญุงูุฉ ุงูุฏูุน
```typescript
paymentStatus = total_paid >= contract_amount ? 'paid' : 'pending';
```

### 5. ุงูุชูุงุฑูุฎ
```typescript
// ุชูุณูู ุนุฑุจู
format(new Date(date), 'dd/MM/yyyy', { locale: ar });
```

---

## โ ูุนุงูุฌุฉ ุงูุญุงูุงุช

### 1. ุญุงูุฉ ุงูุชุญููู
```typescript
if (isLoading) {
  return <PageSkeletonFallback />;
}
```

### 2. ุญุงูุฉ ุงูุฎุทุฃ
```typescript
if (customerError || !customer) {
  return (
    <Card>
      <h3>ุงูุนููู ุบูุฑ ููุฌูุฏ</h3>
      <Button>ุงูุนูุฏุฉ</Button>
    </Card>
  );
}
```

### 3. ูุง ุชูุฌุฏ ุจูุงูุงุช
```typescript
{formattedContracts.length > 0 ? (
  // ุนุฑุถ ุงูุนููุฏ
) : (
  <Card>ูุง ุชูุฌุฏ ุนููุฏ</Card>
)}
```

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุขู ุนูุฏ ูุชุญ ุตูุญุฉ ุงูุนููู:

```
1. /customers โ ุงุฎุชุฑ ุนููู
2. ุชูุชุญ ุงูุตูุญุฉ ุงููุงููุฉ
3. ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ:
   โ ุงุณู ุงูุนููู ุงูุญูููู (ูู DB)
   โ ูุนูููุงุช ุงูุงุชุตุงู ุงูุญููููุฉ
   โ ุนููุฏู ุงููุนููุฉ (ูู DB)
   โ ูุฏููุนุงุชู ุงูุญููููุฉ (ูู DB)
   โ ุฅุญุตุงุฆูุงุช ูุญุณูุจุฉ ูู ุงูุจูุงูุงุช
```

---

## ๐ ุงูุชุญุฏูุซุงุช ุงููุทุจูุฉ

### ูู ุงูููู:
- [x] โ ุงุณุชูุฑุงุฏ useQuery
- [x] โ ุงุณุชูุฑุงุฏ supabase
- [x] โ ุฌูุจ ุจูุงูุงุช ุงูุนููู ูู DB
- [x] โ ุฌูุจ ุงูุนููุฏ ูู DB (ูุน ุงูุณูุงุฑุงุช)
- [x] โ ุฌูุจ ุงููุฏููุนุงุช ูู DB
- [x] โ ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช ูู ุงูุจูุงูุงุช ุงูุญููููุฉ
- [x] โ ุชูุณูู ุงุณู ุงูุนููู (ูุฑุฏ/ุดุฑูุฉ)
- [x] โ ุชูุณูู ุจูุงูุงุช ุงูุนููุฏ
- [x] โ ุชูุณูู ุจูุงูุงุช ุงููุฏููุนุงุช
- [x] โ ูุนุงูุฌุฉ ุญุงูุงุช ุงูุชุญููู
- [x] โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- [x] โ ุชูุณูู ุงูุชูุงุฑูุฎ
- [x] โ ุญุณุงุจ ุงูุฃูุงู ุงููุชุจููุฉ
- [x] โ ุนุฑุถ ูุงุฑุบ ุฅุฐุง ูุง ุชูุฌุฏ ุจูุงูุงุช
- [x] โ Zero linting errors

---

## ๐ฏ ุงููุฑู

### ูุจู:
```
๐ ุนุฏุฏ ุงูุนููุฏ ุงููุดุทุฉ: 3 (ุซุงุจุช)
๐ฐ ุงููุจูุบ ุงููุณุชุญู: 5,000 ุฑ.ุณ (ุซุงุจุช)
๐ ูุณุจุฉ ุงูุงูุชุฒุงู: 95% (ุซุงุจุช)
๐ณ ุฅุฌูุงูู ุงููุฏููุนุงุช: 125,000 ุฑ.ุณ (ุซุงุจุช)

ุงูุนููุฏ: 3 ุนููุฏ ููููุฉ (ุซุงุจุชุฉ)
ุงููุฏููุนุงุช: 3 ุฏูุนุงุช ููููุฉ (ุซุงุจุชุฉ)
```

### ุงูุขู:
```
๐ ุนุฏุฏ ุงูุนููุฏ ุงููุดุทุฉ: ูุญุณูุจ ูู DB
๐ฐ ุงููุจูุบ ุงููุณุชุญู: ูุญุณูุจ ูู (contract_amount - total_paid)
๐ ูุณุจุฉ ุงูุงูุชุฒุงู: ูุญุณูุจุฉ ูู (ูุฏููุน ูู ุงูููุช / ุงูุฅุฌูุงูู)
๐ณ ุฅุฌูุงูู ุงููุฏููุนุงุช: ูุฌููุน ุฌููุน ุงููุฏููุนุงุช ุงูุญููููุฉ

ุงูุนููุฏ: ูู ุฌุฏูู contracts (ุญููููุฉ)
ุงููุฏููุนุงุช: ูู ุฌุฏูู payments (ุญููููุฉ)
```

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงูุชุญ ุงูุชุทุจูู
```bash
npm run dev
```

### 2. ุงูุชูู ูุตูุญุฉ ุงูุนููุงุก
```
/customers
```

### 3. ุงุฎุชุฑ ุฃู ุนููู ููุฌูุฏ

### 4. ุชุญูู ูู:
- โ ุงุณู ุงูุนููู ุตุญูุญ (ูู DB)
- โ ุฑูู ุงููููุฉ ุตุญูุญ
- โ ุงูุฌูุงู ุตุญูุญ
- โ ุนุฏุฏ ุงูุนููุฏ ุตุญูุญ
- โ ุงููุฏููุนุงุช ุตุญูุญุฉ
- โ ุงูุฅุญุตุงุฆูุงุช ูุญุณูุจุฉ ุจุดูู ุตุญูุญ

---

## โจ ุงูุฎูุงุตุฉ

### ุชู ุชุญููู ุงูุตูุญุฉ ูู:
โ ุจูุงูุงุช ููููุฉ ุซุงุจุชุฉ

### ุฅูู:
โ **ุจูุงูุงุช ุญููููุฉ 100%** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช  
โ **ุฅุญุตุงุฆูุงุช ูุญุณูุจุฉ** ูู ุงูุจูุงูุงุช ุงูุญููููุฉ  
โ **ุชูุณูู ุชููุงุฆู** ููุชูุงุฑูุฎ ูุงูุฃุฑูุงู  
โ **ูุนุงูุฌุฉ ุดุงููุฉ** ููุฃุฎุทุงุก ูุงูุชุญููู  
โ **ุฃุฏุงุก ูุญุณูู** ูุน React Query  

---

<div align="center" style="border: 2px solid #b91c1c; padding: 2rem;">

## ๐ ุตูุญุฉ ุชูุงุตูู ุงูุนููู ูุญุฏุซุฉ!

### ุจูุงูุงุช ุญููููุฉ 100% ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**โ ูุนูููุงุช ุงูุนููู** - ูู DB  
**โ ุงูุนููุฏ** - ูู DB  
**โ ุงููุฏููุนุงุช** - ูู DB  
**โ ุงูุฅุญุตุงุฆูุงุช** - ูุญุณูุจุฉ  

### ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู ุงูููุฑู!

**ุงูุชุญ:** `/customers` โ ุงุฎุชุฑ ุนููู โ **ุจูุงูุงุช ุญููููุฉ!**

</div>

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 28 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ููุชูู  
**ุงูุจูุงูุงุช:** โ ุญููููุฉ 100%  
**ุงูุฃุฎุทุงุก:** โ ุตูุฑ

