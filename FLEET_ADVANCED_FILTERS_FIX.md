# ุฅุตูุงุญ ุฎุทุฃ ุงูููุงุชุฑ ุงููุชูุฏูุฉ ูู ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุฃุณุทูู
## Fleet Advanced Filters Error Fix

**ุงูุชุงุฑูุฎ**: 2025-01-19  
**ุงูุญุงูุฉ**: โ ุชู ุงูุฅุตูุงุญ

---

## ๐ ุงููุดููุฉ ุงูุฃุตููุฉ

ุนูุฏ ุงุณุชุฎุฏุงู ุงูููุงุชุฑ ุงููุชูุฏูุฉ ูู ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุฃุณุทูู (`/fleet`)ุ ูุงู ูุญุฏุซ ุฎุทุฃ ุนูุฏ ุชูุนูู ุฃุญุฏ ุงูููุงุชุฑ ุงูุชุงููุฉ:
- ููุชุฑ ุงูุตูุงูุฉ ุงููุณุชุญูุฉ (Maintenance Due)
- ููุชุฑ ุงูุชุฃููู ุงูููุชูู (Insurance Expiring)

### ุงูุณุจุจ ุงูุฌุฐุฑู

ูุงู ุงูุณุจุจ ูู ุงุณุชุฎุฏุงู ุนูููุงุช ุงูููุงุฑูุฉ `.gte()` ู `.lte()` ุนูู ุงูุญููู ุงูุชู ูุฏ ุชุญุชูู ุนูู ููู `NULL`:
- `inspection_due_date` - ุชุงุฑูุฎ ุงููุญุต ุงููุณุชุญู
- `insurance_expiry` - ุชุงุฑูุฎ ุงูุชูุงุก ุงูุชุฃููู

ุนูุฏูุง ุชููู ูุฐู ุงูุญููู `NULL`ุ ูุฅู Supabase/PostgreSQL ูุง ููููู ุฅุฌุฑุงุก ุงูููุงุฑูุงุช ุงูุฑูููุฉ ุนูููุงุ ููุง ูุคุฏู ุฅูู ุณููู ุบูุฑ ูุชููุน ุฃู ุฃุฎุทุงุก.

---

## ๐ง ุงูุฅุตูุงุญ ุงููุทุจู

### ุงูููู ุงููุนุฏู
**ุงูููู**: `src/hooks/useVehiclesPaginated.ts`  
**ุงูุณุทูุฑ**: 95-119

### ุงูุชุบููุฑุงุช

#### ูุจู ุงูุฅุตูุงุญ โ
```typescript
// Apply maintenance due filter
if (filters.maintenanceDue) {
  const today = new Date().toISOString().split('T')[0];
  const nextMonth = new Date();
  nextMonth.setMonth(nextMonth.getMonth() + 1);
  const nextMonthStr = nextMonth.toISOString().split('T')[0];
  
  query = query.gte('inspection_due_date', today).lte('inspection_due_date', nextMonthStr);
}

// Apply insurance expiring filter
if (filters.insuranceExpiring) {
  const today = new Date().toISOString().split('T')[0];
  const nextMonth = new Date();
  nextMonth.setMonth(nextMonth.getMonth() + 1);
  const nextMonthStr = nextMonth.toISOString().split('T')[0];
  
  query = query.gte('insurance_expiry', today).lte('insurance_expiry', nextMonthStr);
}
```

#### ุจุนุฏ ุงูุฅุตูุงุญ โ
```typescript
// Apply maintenance due filter
if (filters.maintenanceDue) {
  const today = new Date().toISOString().split('T')[0];
  const nextMonth = new Date();
  nextMonth.setMonth(nextMonth.getMonth() + 1);
  const nextMonthStr = nextMonth.toISOString().split('T')[0];
  
  query = query
    .not('inspection_due_date', 'is', null)  // โ ุงุณุชุจุนุงุฏ ุงูููู NULL
    .gte('inspection_due_date', today)
    .lte('inspection_due_date', nextMonthStr);
}

// Apply insurance expiring filter
if (filters.insuranceExpiring) {
  const today = new Date().toISOString().split('T')[0];
  const nextMonth = new Date();
  nextMonth.setMonth(nextMonth.getMonth() + 1);
  const nextMonthStr = nextMonth.toISOString().split('T')[0];
  
  query = query
    .not('insurance_expiry', 'is', null)  // โ ุงุณุชุจุนุงุฏ ุงูููู NULL
    .gte('insurance_expiry', today)
    .lte('insurance_expiry', nextMonthStr);
}
```

---

## ๐ก ุดุฑุญ ุงูุญู

### ุงูุฅุถุงูุฉ ุงูุฑุฆูุณูุฉ
```typescript
.not('column_name', 'is', null)
```

ูุฐุง ุงูุณุทุฑ ูุถูู ุฃู:
1. **ุงุณุชุจุนุงุฏ ุงูุณุฌูุงุช** ุงูุชู ุชุญุชูู ุนูู `NULL` ูู ุญูู ุงูุชุงุฑูุฎ
2. **ุชุทุจูู ุงูููุงุฑูุงุช** ููุท ุนูู ุงูุณุฌูุงุช ุงูุชู ุชุญุชูู ุนูู ุชูุงุฑูุฎ ูุนููุฉ
3. **ููุน ุงูุฃุฎุทุงุก** ุงููุงุชุฌุฉ ุนู ูุญุงููุฉ ููุงุฑูุฉ `NULL` ูุน ููู ุงูุชุงุฑูุฎ

### ุงูุณููู ุงูุฌุฏูุฏ

**ููุชุฑ ุงูุตูุงูุฉ ุงููุณุชุญูุฉ** (`maintenanceDue`):
- โ ูุนุฑุถ ููุท ุงููุฑูุจุงุช ุงูุชู ูุฏููุง ุชุงุฑูุฎ ูุญุต ูุณุชุญู
- โ ูุนุฑุถ ุงููุฑูุจุงุช ุงูุชู ุชุงุฑูุฎ ูุญุตูุง ุฎูุงู ุงูุดูุฑ ุงููุงุฏู
- โ ูุณุชุจุนุฏ ุงููุฑูุจุงุช ุงูุชู ููุณ ูุฏููุง ุชุงุฑูุฎ ูุญุต ูุญุฏุฏ

**ููุชุฑ ุงูุชุฃููู ุงูููุชูู** (`insuranceExpiring`):
- โ ูุนุฑุถ ููุท ุงููุฑูุจุงุช ุงูุชู ูุฏููุง ุชุงุฑูุฎ ุงูุชูุงุก ุชุฃููู
- โ ูุนุฑุถ ุงููุฑูุจุงุช ุงูุชู ุชุฃููููุง ููุชูู ุฎูุงู ุงูุดูุฑ ุงููุงุฏู
- โ ูุณุชุจุนุฏ ุงููุฑูุจุงุช ุงูุชู ููุณ ูุฏููุง ุชุงุฑูุฎ ุชุฃููู ูุญุฏุฏ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุฎุทูุงุช ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ

1. **ุงูุชุญ ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุฃุณุทูู**
   ```
   http://localhost:8081/fleet
   ```

2. **ุงุฎุชุจุฑ ููุชุฑ ุงูุตูุงูุฉ ุงููุณุชุญูุฉ**:
   - ุงููุฑ ุนูู ุฒุฑ "ุชุตููุฉ ูุชูุฏูุฉ"
   - ูุนูู ุฎูุงุฑ "ุตูุงูุฉ ูุณุชุญูุฉ (ุฎูุงู ุดูุฑ)"
   - ุชุญูู ูู ุฃู ุงููุงุฆูุฉ ุชูุญุฏูุซ ุจุฏูู ุฃุฎุทุงุก
   - ูุฌุจ ุฃู ุชุนุฑุถ ููุท ุงููุฑูุจุงุช ุงูุชู ูุฏููุง ูุญุต ูุณุชุญู

3. **ุงุฎุชุจุฑ ููุชุฑ ุงูุชุฃููู ุงูููุชูู**:
   - ุงููุฑ ุนูู ุฒุฑ "ุชุตููุฉ ูุชูุฏูุฉ"
   - ูุนูู ุฎูุงุฑ "ุชุฃููู ููุชูู ุงูุตูุงุญูุฉ (ุฎูุงู ุดูุฑ)"
   - ุชุญูู ูู ุฃู ุงููุงุฆูุฉ ุชูุญุฏูุซ ุจุฏูู ุฃุฎุทุงุก
   - ูุฌุจ ุฃู ุชุนุฑุถ ููุท ุงููุฑูุจุงุช ุงูุชู ุชุฃููููุง ููุชูู ูุฑูุจุงู

4. **ุงุฎุชุจุฑ ุงูููุงุชุฑ ุงูุฃุฎุฑู**:
   - ุงููุงุฑูุฉ ูุงูููุฏูู
   - ูุทุงู ุงูุณูุฉ
   - ููุน ุงููููุฏ
   - ููุน ุงูููู
   - ุฌููุนูุง ูุฌุจ ุฃู ุชุนูู ุจุดูู ุตุญูุญ

### ุงููุชุงุฆุฌ ุงููุชููุนุฉ โ

- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู console ุงููุชุตูุญ
- โ ุงููุงุฆูุฉ ุชูุญุฏูุซ ุจุณูุงุณุฉ ุนูุฏ ุชุบููุฑ ุงูููุงุชุฑ
- โ ุงููุชุงุฆุฌ ุฏูููุฉ ููุชูุงููุฉ ูุน ุงูููุงุชุฑ ุงููุฎุชุงุฑุฉ
- โ ูุคุดุฑ ุงูููุงุชุฑ ุงููุดุทุฉ ูุนูู ุจุดูู ุตุญูุญ

---

## ๐ ุงูุชุฃุซูุฑ

### ุงููููุงุช ุงููุชุฃุซุฑุฉ
- โ `src/hooks/useVehiclesPaginated.ts` - ุชู ุงูุชุญุฏูุซ

### ุงููููุงุช ุฐุงุช ุงูุตูุฉ (ูู ุชุชุบูุฑ)
- `src/pages/Fleet.tsx` - ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุฃุณุทูู
- `src/components/fleet/VehicleFilters.tsx` - ูููู ุงูููุงุชุฑ ุงููุชูุฏูุฉ
- `src/components/fleet/VehicleGrid.tsx` - ุนุฑุถ ุงููุฑูุจุงุช

---

## ๐ ููุงุญุธุงุช ูููุฉ

### ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุชุฃูุฏูุง ูู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ุงูุตุญูุญุฉ:
- โ `transmission_type` (ููุณ `transmission`)
- โ `fuel_type` 
- โ `inspection_due_date`
- โ `insurance_expiry`

### ููุท ุงูุงุณุชุนูุงู ูู Supabase

```typescript
// ุงูููุท ุงูุตุญูุญ ููููุชุฑุฉ ูุน ุงูููู NULL
query = query
  .not('column', 'is', null)    // ุงุณุชุจุนุงุฏ NULL
  .gte('column', minValue)       // ุฃูุจุฑ ูู ุฃู ูุณุงูู
  .lte('column', maxValue)       // ุฃุตุบุฑ ูู ุฃู ูุณุงูู
```

---

## ๐ ุงูุฅุตุฏุงุฑ

**ุงูุญุงูุฉ ุงูุญุงููุฉ**: โ ุฌุงูุฒ ููุฅูุชุงุฌ  
**ุงูุชูุงูู**: ูุชูุงูู ูุน ุฌููุน ุงููุชุตูุญุงุช ุงูุญุฏูุซุฉ  
**ุงูุฃุฏุงุก**: ูุง ููุฌุฏ ุชุฃุซูุฑ ุณูุจู ุนูู ุงูุฃุฏุงุก

---

## ๐ ุงูุชูุตูุงุช ุงููุณุชูุจููุฉ

1. **ุฅุถุงูุฉ ุฑุณุงุฆู ุชูุถูุญูุฉ** ุนูุฏูุง ูุง ุชูุฌุฏ ูุชุงุฆุฌ ุจุณุจุจ ุนุฏู ูุฌูุฏ ุชูุงุฑูุฎ
2. **ุฅุถุงูุฉ ููุชุฑ ูุนุฑุถ ุงููุฑูุจุงุช ุจุฏูู ุชูุงุฑูุฎ** ูุญุฏุฏุฉ
3. **ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู** ุจุฅุถุงูุฉ tooltips ุชูุถูุญูุฉ ุนูู ุงูููุงุชุฑ

---

**ุชู ุงูุชูุซูู ุจูุงุณุทุฉ**: Qoder AI Assistant  
**ุชุงุฑูุฎ ุงูุชูุซูู**: 2025-01-19
