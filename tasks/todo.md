# TODO: ุฅุถุงูุฉ ููู Excel ูุจูุงูุงุช ุงููุถุงูุง โ

## ุงูููุงู ุงูููุชููุฉ:
- [x] โ **1. ุชุซุจูุช ููุชุจุฉ `xlsx`**
  - ุชู ุชุซุจูุช ููุชุจุฉ `xlsx` ุจูุฌุงุญ
  - ุงูุฅุตุฏุงุฑ: ุฃุญุฏุซ ุฅุตุฏุงุฑ ูุชุงุญ

- [x] โ **2. ุฅูุดุงุก ููู `lawsuitExcelGenerator.ts`**
  - ุฅูุดุงุก ูุงุฌูุฉ `LawsuitExcelData` ููุจูุงูุงุช
  - ุฏุงูุฉ `extractLawsuitData()` ูุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ูู ุงููุณุชูุฏุงุช
  - ุฏุงูุฉ `numberToArabicWords()` ูุชุญููู ุงูุฃุฑูุงู ุฅูู ูููุงุช ุนุฑุจูุฉ
  - ุฏุงูุฉ `createLawsuitExcelFile()` ูุฅูุดุงุก ููู Excel ูุน ุชูุณูู ุงุญุชุฑุงูู

- [x] โ **3. ุชุญุฏูุซ `bulkDocumentGenerator.ts`**
  - ุฅุถุงูุฉ ุงุณุชูุฑุงุฏ `lawsuitExcelGenerator`
  - ุชุญุฏูุซ `generateBulkDocumentsZip()` ูุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุงููุถุงูุง
  - ุฅูุดุงุก ููู `ุจูุงูุงุช_ุงููุถุงูุง.xlsx` ูุฅุถุงูุชู ููู ZIP
  - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุตุญูุญ

## ุงูุจูุงูุงุช ุงููุถุงูุฉ ูู Excel:

| ุงูุนููุฏ | ุงููุตู | ุงููุตุฏุฑ |
|--------|-------|--------|
| ุนููุงู ุงูุฏุนูู | ุนููุงู ุงูุฏุนูู ุงููุงูู | ูููุดุฃ ุชููุงุฆูุงู |
| ุงูููุงุฆุน | ุชูุงุตูู ููุงุฆุน ุงููุถูุฉ | ูู ุงููุฐูุฑุฉ ุงูุดุงุฑุญุฉ |
| ุงูุทูุจุงุช | ุทูุจุงุช ุงููุฏุนู | ูู ุงููุฐูุฑุฉ ุงูุดุงุฑุญุฉ |
| ูููุฉ ุงููุทุงูุจุฉ | ุงููุจูุบ ุงูุฅุฌูุงูู (ุฑูู) | ูุญุณูุจ |
| ุงููุจูุบ ุจุงูุญุฑูู | ุงููุจูุบ ุจุงููููุงุช ุงูุนุฑุจูุฉ | ูุญุณูุจ |
| ุงูุงุณู ุงูุฃูู | ุงุณู ุงููุฏุนู ุนููู ุงูุฃูู | ูู ุจูุงูุงุช ุงูุนููู |
| ุงูุงุณู ุงูุฃูุณุท | ุงูุงุณู ุงูุฃูุณุท | ูู ุจูุงูุงุช ุงูุนููู |
| ุงูุงุณู ุงูุฃุฎูุฑ | ุงุณู ุงูุนุงุฆูุฉ | ูู ุจูุงูุงุช ุงูุนููู |
| ุงูุฌูุณูุฉ | ุฌูุณูุฉ ุงููุฏุนู ุนููู | ูู ุจูุงูุงุช ุงูุนููู |
| ุฑูู ุงููููุฉ | ุฑูู ุงููููุฉ/ุงูุฅูุงูุฉ | ูู ุจูุงูุงุช ุงูุนููู |
| ุงูุนููุงู | ุนููุงู ุงููุฏุนู ุนููู | ูู ุจูุงูุงุช ุงูุนููู |
| ุงููุงุชู | ุฑูู ุงููุงุชู | ูู ุจูุงูุงุช ุงูุนููู |
| ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | ูู ุจูุงูุงุช ุงูุนููู |

## ุงูููุฒุงุช:
โ **ุชูุณูู ุงุญุชุฑุงูู:**
- ุนุฑุถ ุงูุฃุนูุฏุฉ ููุงุณุจ ูููุฑุงุกุฉ
- ุงุฑุชูุงุน ุงูุตููู ูุณุชูุนุจ ุงููุตูุต ุงูุทูููุฉ
- ุฑุฃุณ ุฌุฏูู ูุงุถุญ ุจุงูุนุฑุจูุฉ

โ **ุจูุงูุงุช ูุงููุฉ:**
- ุฌููุน ุงูุจูุงูุงุช ุงููุทููุจุฉ ูู ุฌุฏูู `lawsuit_templates`
- ุงูููุงุฆุน ูุงูุทูุจุงุช ูููุดุฃุฉ ุชููุงุฆูุงู ูู ุงููุฐูุฑุฉ ุงูุดุงุฑุญุฉ
- ุชุญููู ุงููุจุงูุบ ุฅูู ูููุงุช ุนุฑุจูุฉ

โ **ุชูุงูู ุณูุณ:**
- ูููุดุฃ ุชููุงุฆูุงู ูุน ููู ZIP
- ูุง ูุชุทูุจ ุฎุทูุงุช ุฅุถุงููุฉ ูู ุงููุณุชุฎุฏู
- ูุนุงูุฌุฉ ุฃุฎุทุงุก ูููุฉ

## ุงููููุงุช ุงููุชุฃุซุฑุฉ:
- โ `package.json` (ุฅุถุงูุฉ ููุชุจุฉ xlsx)
- โ `src/utils/lawsuitExcelGenerator.ts` (ููู ุฌุฏูุฏ)
- โ `src/utils/bulkDocumentGenerator.ts` (ุชุญุฏูุซ)

## ุงููุชูุฌุฉ:
ุงูุขู ุนูุฏ ุฅูุดุงุก ููู ZIP ูููุถุงูุงุ ุณูุชู ุฅุถุงูุฉ ููู `ุจูุงูุงุช_ุงููุถุงูุง.xlsx` ุชููุงุฆูุงู ูุญุชูู ุนูู ุฌููุน ุจูุงูุงุช ุงููุถุงูุง ุจุชูุณูู Excel ุฌุงูุฒ ููุงุณุชูุฑุงุฏ ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช! ๐โจ

---

## ๐ ุฅุตูุงุญ ุงูุฃุฎุทุงุก:

### ุงูุฎุทุฃ: `invalid input syntax for type uuid: "[object Object]"`
**ุงูุณุจุจ:** ุชู ุชูุฑูุฑ ูุงุฆู `customer` ูุงูู ุฅูู `fetchCustomerFullData()` ุจุฏูุงู ูู `contract_id` (string)

**ุงูุญู:** โ
```typescript
// ูุจู (ุฎุทุฃ):
const fullData = await fetchCustomerFullData(customer);

// ุจุนุฏ (ุตุญูุญ):
const contractId = customer.contract_id || customer.id;
const fullData = await fetchCustomerFullData(contractId);
```

**ุงูููู ุงููุญุฏุซ:** `src/utils/bulkDocumentGenerator.ts` (ุงูุณุทุฑ 580-581)

---

### ุงูุฎุทุฃ: `Cannot read properties of undefined (reading 'name_ar')`
**ุงูุณุจุจ:** ุฏุงูุฉ `fetchCustomerFullData()` ูุง ุชูุฑุฌุน `companyInfo` ู `vehicleData` ุงููุงุฒูุฉ ูู `extractLawsuitData()`

**ุงูุญู:** โ
```typescript
// ุฅุถุงูุฉ ุฌูุจ ูุนูููุงุช ุงูุดุฑูุฉ
const { data: companyData } = await supabase
  .from('companies')
  .select('*')
  .eq('id', contractResult.data.company_id)
  .single();

return { 
  contract: contractResult.data, 
  invoices: invoicesResult.data || [], 
  violations: violationsResult.data || [],
  vehicleData: contractResult.data.vehicles,  // โ ุฅุถุงูุฉ
  companyInfo: companyData || {}              // โ ุฅุถุงูุฉ
};
```

**ุงูููู ุงููุญุฏุซ:** `src/utils/bulkDocumentGenerator.ts` (ุงูุณุทุฑ 152-168)

---

## โ ุฅุถุงูุฉ ุตูุญุฉ "ุจูุงูุงุช ุงูุชูุงุถู"

### ุงูููุงู ุงูููุชููุฉ:

#### 1. **ุชุบููุฑ ุงุณู ุงูุฒุฑ** โ
- **ุงููููุน:** `/legal/delinquency`
- **ุงูุชุบููุฑ:** ูู "ุฅุนุฏุงุฏ ุฏุนูู" ุฅูู "ุจูุงูุงุช ุชูุงุถู"
- **ุงูููู:** `src/pages/legal/FinancialDelinquency.tsx`

#### 2. **ุฅูุดุงุก ุตูุญุฉ ุฌุฏูุฏุฉ** โ
- **ุงููุณุงุฑ:** `/legal/lawsuit-data`
- **ุงูููู:** `src/pages/legal/LawsuitDataPage.tsx`
- **ุงูููุฒุงุช:**
  - ุนุฑุถ ุฌุฏูู ุจูุงูุงุช ุงููุถุงูุง
  - ุจุทุงูุงุช ุฅุญุตุงุฆูุฉ (ุฅุฌูุงูู ุงููุถุงูุงุ ุงููุทุงูุจุงุชุ ุขุฎุฑ ุชุญุฏูุซ)
  - ุจุญุซ ูุชูุฏู (ุจุงูุงุณูุ ุฑูู ุงููููุฉุ ุนููุงู ุงูุฏุนูู)
  - ุนุฑุถ ุชูุงุตูู ูู ูุถูุฉ
  - ุญุฐู ุงููุถุงูุง
  - ุชุญุฏูุซ ุงูุจูุงูุงุช

#### 3. **ุฅูุดุงุก ุฌุฏูู ูุงุนุฏุฉ ุงูุจูุงูุงุช** โ
- **ุงูุฌุฏูู:** `lawsuit_templates`
- **ุงูููู:** `supabase/migrations/20260127000003_create_lawsuit_templates_table.sql`
- **ุงูุญููู:**
  - ูุนูููุงุช ุงูุฏุนูู (ุงูุนููุงูุ ุงูููุงุฆุนุ ุงูุทูุจุงุช)
  - ุงููุจุงูุบ ุงููุงููุฉ (ูููุฉ ุงููุทุงูุจุฉุ ุงููุจูุบ ุจุงูุญุฑูู)
  - ูุนูููุงุช ุงููุฏุนู ุนููู (ุงูุงุณูุ ุงูุฌูุณูุฉุ ุงููููุฉุ ุงูุนููุงูุ ุงููุงุชูุ ุงูุจุฑูุฏ)
  - ุฑุจุท ุจุงูุนูุฏ ูุงูุนููู (ุงุฎุชูุงุฑู)
- **ุงูููุฒุงุช:**
  - RLS (Row Level Security) ููุฃูุงู
  - ููุงุฑุณ ููุฃุฏุงุก
  - Trigger ูุชุญุฏูุซ `updated_at` ุชููุงุฆูุงู

#### 4. **ุญูุธ ุงูุจูุงูุงุช ุชููุงุฆูุงู** โ
- **ุงูููู:** `src/utils/bulkDocumentGenerator.ts`
- **ุงูุขููุฉ:**
  - ุนูุฏ ุฅูุดุงุก ููู ZIPุ ูุชู ุญูุธ ุจูุงูุงุช ุงููุถุงูุง ูู ุงูุฌุฏูู ุชููุงุฆูุงู
  - ูุชู ุฑุจุท ุงูุจูุงูุงุช ุจู `company_id` ุงูุญุงูู
  - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุตุญูุญ

### ุงููุชูุฌุฉ:
ุงูุขู ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "ุจูุงูุงุช ุชูุงุถู" ูู ุตูุญุฉ `/legal/delinquency`ุ ุณูุชู ูุชุญ ุตูุญุฉ ุฌุฏูุฏุฉ ุชุนุฑุถ ุฌููุน ุจูุงูุงุช ุงููุถุงูุง ุงููููุดุฃุฉ ูู ูููุงุช Excel! ๐โจ

---

## โ ุชุญุฏูุซ ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู Excel

### ุงูุชุบููุฑุงุช:
ุชู ุชุญุฏูุซ ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู ููู Excel ูุชุทุงุจู ุงููุณููุงุช ุงูุฑุณููุฉ:

| ูุจู | ุจุนุฏ |
|-----|-----|
| ุงูุงุณู ุงูุฃูู | ุงุณู ุงููุฏุนู ุนููู ุงูุฃูู |
| ุงูุงุณู ุงูุฃูุณุท | ุงุณู ุงููุฏุนู ุนููู ุงูุซุงูุซ |
| ุงูุงุณู ุงูุฃุฎูุฑ | ุงุณู ุงููุฏุนู ุนููู ุงูุฃุฎูุฑ |
| ุงูุฌูุณูุฉ | ุฌูุณูุฉ ุงููุฏุนู ุนููู |
| ุฑูู ุงููููุฉ | ุฑูู ูููุฉ ุงููุฏุนู ุนููู |
| ุงูุนููุงู | ุนููุงู ุงููุฏุนู ุนููู |
| ุงููุงุชู | ูุงุชู ุงููุฏุนู ุนููู |
| ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | ุจุฑูุฏ ุงููุฏุนู ุนููู ุงูุฅููุชุฑููู |

### ุชุญุณููุงุช ุฅุถุงููุฉ:
- โ ุฒูุงุฏุฉ ุนุฑุถ ุงูุฃุนูุฏุฉ ูููุตูุต ุงูุทูููุฉ (ุงูููุงุฆุนุ ุงูุทูุจุงุช)
- โ ุชุญุณูู ุนุฑุถ ุฃุนูุฏุฉ ุงูุฃุณูุงุก ูุงูุนูุงููู
- โ ุชูุณูู ุงุญุชุฑุงูู ูุทุงุจู ุงููุชุทูุจุงุช ุงููุงููููุฉ

**ุงูููู ุงููุญุฏุซ:** `src/utils/lawsuitExcelGenerator.ts`

---

## โ ุชุญุฏูุซ ุตูุญุฉ "ุจูุงูุงุช ุงูุชูุงุถู"

### ุงูุชุบููุฑุงุช:
ุชู ุชุญุฏูุซ ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู ุตูุญุฉ `/legal/lawsuit-data` ูุชุทุงุจู ููู Excel:

**ุงูุฃุนูุฏุฉ ุงููุญุฏุซุฉ:**
1. #
2. ุนููุงู ุงูุฏุนูู
3. **ุงุณู ุงููุฏุนู ุนููู ุงูุฃูู** (ูููุตู)
4. **ุงุณู ุงููุฏุนู ุนููู ุงูุซุงูุซ** (ูููุตู)
5. **ุงุณู ุงููุฏุนู ุนููู ุงูุฃุฎูุฑ** (ูููุตู)
6. **ุฑูู ูููุฉ ุงููุฏุนู ุนููู**
7. ูููุฉ ุงููุทุงูุจุฉ
8. **ุฌูุณูุฉ ุงููุฏุนู ุนููู**
9. ุชุงุฑูุฎ ุงูุฅูุดุงุก
10. ุงูุฅุฌุฑุงุกุงุช

### ุงูุชุญุณููุงุช:
- โ ูุตู ุงูุงุณู ุฅูู 3 ุฃุนูุฏุฉ ูููุตูุฉ (ุงูุฃููุ ุงูุซุงูุซุ ุงูุฃุฎูุฑ)
- โ ุฅุถุงูุฉ "-" ููุฃุณูุงุก ุงููุณุทู ุงููุงุฑุบุฉ
- โ ุชุญุฏูุซ `colSpan` ูู 8 ุฅูู 10 ูุฑุณุงูุฉ "ูุง ุชูุฌุฏ ุจูุงูุงุช"
- โ ุชูุญูุฏ ุงููุณููุงุช ูุน ููู Excel

**ุงูููู ุงููุญุฏุซ:** `src/pages/legal/LawsuitDataPage.tsx`
